2025-03-14 18:53:01,620 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 18:53:01,620 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 18:53:01,656 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 18:53:02,804 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 18:53:02,805 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 18:53:02,849 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 18:53:02,937 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 18:53:02,971 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 18:53:02,971 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 18:53:02,971 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 18:53:02,972 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 18:53:02,972 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 18:53:02,972 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 18:53:05,290 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 18:53:05,291 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 18:53:05,753 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 18:53:05,754 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 18:53:06,174 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 18:53:06,175 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 18:53:06,621 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 18:53:06,622 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 18:53:06,622 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00058s] {}
2025-03-14 18:53:07,046 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 18:53:07,638 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 18:53:07,639 - MultasGO - INFO - [direct_search_service.py:29] - Pesquisando por '' (limit=500, skip=0)
2025-03-14 18:53:07,639 - MultasGO - INFO - [infracoes.py:49] - Listagem de infrações: 0 registros retornados
2025-03-14 18:53:07,639 - MultasGO - WARNING - [infracoes.py:52] - Nenhuma infração encontrada
2025-03-14 18:53:21,038 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 18:53:21,039 - MultasGO - INFO - [direct_search_service.py:29] - Pesquisando por '7579' (limit=10, skip=0)
2025-03-14 18:53:23,261 - MultasGO - INFO - [direct_search_service.py:50] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 18:53:23,262 - MultasGO - INFO - [direct_search_service.py:60] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 18:53:23,262 - MultasGO - INFO - [direct_search_service.py:61] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 18:53:23,263 - MultasGO - INFO - [direct_search_service.py:72] - Buscando por código exato: 7579
2025-03-14 18:53:23,483 - MultasGO - INFO - [direct_search_service.py:86] - Buscando por código parcial: 7579
2025-03-14 18:53:23,702 - MultasGO - INFO - [direct_search_service.py:159] - Pesquisa por '7579' concluída. Total de resultados: 1
2025-03-14 18:53:23,703 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 1
2025-03-14 18:53:27,067 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 18:53:27,067 - MultasGO - INFO - [direct_search_service.py:29] - Pesquisando por '7579-0' (limit=10, skip=0)
2025-03-14 18:53:29,098 - MultasGO - INFO - [direct_search_service.py:50] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 18:53:29,098 - MultasGO - INFO - [direct_search_service.py:60] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 18:53:29,099 - MultasGO - INFO - [direct_search_service.py:61] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 18:53:29,099 - MultasGO - INFO - [direct_search_service.py:72] - Buscando por código exato: 7579-0
2025-03-14 18:53:29,313 - MultasGO - INFO - [direct_search_service.py:86] - Buscando por código parcial: 7579-0
2025-03-14 18:53:29,518 - MultasGO - INFO - [direct_search_service.py:101] - Buscando por texto: 7579-0
2025-03-14 18:53:29,923 - MultasGO - INFO - [direct_search_service.py:159] - Pesquisa por '7579-0' concluída. Total de resultados: 0
2025-03-14 18:53:29,923 - MultasGO - INFO - [direct_search_service.py:168] - Sugestão para '7579-0': Tente buscar por: Estacionar nas pontes , Estacionar ao lado ou sobre gramado ou jardim público , Estacionar na área de cruzamento de vias  ou um número como 55172
2025-03-14 18:53:29,924 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 18:53:29,924 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente buscar por: Estacionar nas pontes , Estacionar ao lado ou sobre gramado ou jardim público , Estacionar na área de cruzamento de vias  ou um número como 55172'
2025-03-14 19:09:19,539 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:09:19,539 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:09:19,570 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:20:17,210 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:20:17,210 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:20:17,244 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:21:58,529 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:21:58,530 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:21:58,566 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:21:59,737 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:21:59,738 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:21:59,835 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:22:00,005 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:22:00,046 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:22:00,047 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:22:00,047 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:22:00,047 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:22:00,047 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:22:00,047 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:22:02,166 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:22:02,167 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:22:02,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:22:02,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:22:02,998 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:22:02,999 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:22:03,423 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:22:03,424 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:22:03,425 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00064s] {}
2025-03-14 19:22:03,844 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:22:04,233 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 19:22:04,234 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:04,234 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 31, in listar_infracoes
    resultado = pesquisar_infracoes("", limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:04,235 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:22:08,265 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 19:22:08,265 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:08,266 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:08,267 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:22:12,200 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 19:22:12,201 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:12,201 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:12,202 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:22:14,737 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '5010', skip=0, limit=10
2025-03-14 19:22:14,738 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:14,738 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:14,739 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:22:18,753 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 19:22:18,754 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:18,754 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:18,755 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:22:21,177 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 19:22:21,178 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:22:21,178 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:22:21,179 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:25:32,440 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:25:32,441 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:25:32,496 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:25:32,643 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:25:32,675 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:25:32,675 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:25:32,675 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:25:32,676 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:25:32,676 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:25:32,676 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:25:34,861 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:25:34,862 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:25:35,259 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:25:35,260 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:25:35,658 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:25:35,659 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:25:36,065 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:25:36,066 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:25:36,066 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00075s] {}
2025-03-14 19:25:36,485 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:26:58,906 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:26:58,906 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:26:58,941 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:26:59,075 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:26:59,099 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:26:59,100 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:26:59,100 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:26:59,100 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:26:59,100 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:26:59,100 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:27:01,165 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:27:01,166 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:27:01,578 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:27:01,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:27:01,979 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:27:01,980 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:27:02,400 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:27:02,401 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:27:02,402 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00072s] {}
2025-03-14 19:27:02,814 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:27:14,417 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 19:27:14,418 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: pesquisar_infracoes() missing 1 required positional argument: 'query'
2025-03-14 19:27:14,418 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 100, in pesquisar
    resultado = pesquisar_infracoes(query, limit=limit, skip=skip)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: pesquisar_infracoes() missing 1 required positional argument: 'query'

2025-03-14 19:27:14,419 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:29:31,117 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:29:31,117 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:29:31,155 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:30:22,106 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:30:22,106 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:30:22,148 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:30:34,500 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:30:34,501 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:30:34,540 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:30:49,345 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:30:49,346 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:30:49,394 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:30:53,331 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:30:53,332 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:30:53,368 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:30:58,063 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:30:58,063 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:30:58,099 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:31:59,646 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:31:59,646 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:31:59,676 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:32:00,630 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:32:00,631 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:32:00,667 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:32:00,780 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:32:00,821 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:32:00,821 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:32:00,822 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:32:00,822 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:32:00,822 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:32:00,822 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:32:03,143 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:32:03,144 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:32:03,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:32:03,594 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:32:04,024 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:32:04,025 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:32:04,455 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:04,456 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:32:04,457 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00066s] {}
2025-03-14 19:32:04,883 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:32:12,845 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 19:32:13,058 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:13,060 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 19:32:13,061 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00078s] {'limit': 500, 'skip': 0}
2025-03-14 19:32:13,820 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:13,855 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:13,856 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:13,856 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:13,857 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:13,857 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 19:32:13,858 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00056s] {}
2025-03-14 19:32:14,072 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:32:14,073 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:32:14,073 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:32:14,074 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:32:17,328 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 19:32:17,328 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 19:32:17,545 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:17,545 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:32:17,546 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00080s] {}
2025-03-14 19:32:17,973 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:32:17,974 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:32:17,975 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:32:17,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:32:17,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00076s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 19:32:18,229 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:32:18,230 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:32:18,231 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00112s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 19:32:18,518 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:32:18,519 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:32:18,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00087s] {}
2025-03-14 19:32:18,735 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:32:18,737 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    termos_similares.extend([match for match, score in matches if score > 70])
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    termos_similares.extend([match for match, score in matches if score > 70])
                                       ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:32:18,737 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:32:18,737 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:32:18,739 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:32:20,808 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 19:32:20,808 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 19:32:21,022 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:21,022 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:32:21,023 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.477s ago] {}
2025-03-14 19:32:21,460 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:32:21,461 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:32:21,462 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:32:21,463 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:32:21,464 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.488s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 19:32:21,679 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:32:21,680 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:32:21,681 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.451s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 19:32:21,897 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:32:21,898 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 19:32:21,899 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00071s] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 19:32:22,116 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 19:32:22,117 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:32:22,118 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.599s ago] {}
2025-03-14 19:32:22,344 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:32:22,345 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    termos_similares.extend([match for match, score in matches if score > 70])
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    termos_similares.extend([match for match, score in matches if score > 70])
                                       ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:32:22,346 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:32:22,346 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:32:22,348 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:32:24,759 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 19:32:24,760 - MultasGO - INFO - [search_service.py:116] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 19:32:24,974 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:24,975 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:32:24,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.43s ago] {}
2025-03-14 19:32:25,423 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:32:25,424 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:32:25,424 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:32:25,425 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:32:25,426 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.196s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 19:32:25,644 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 1 resultados novos
2025-03-14 19:32:25,645 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:32:25,646 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.126s ago] {}
2025-03-14 19:32:25,862 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:32:25,863 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    termos_similares.extend([match for match, score in matches if score > 70])
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    termos_similares.extend([match for match, score in matches if score > 70])
                                       ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:32:25,864 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:32:25,864 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:32:25,866 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:32:32,048 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '5010', skip=0, limit=10
2025-03-14 19:32:32,048 - MultasGO - INFO - [search_service.py:116] - Busca original: '5010', normalizada: '5010', código extraído: '5010'
2025-03-14 19:32:32,272 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:32:32,273 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:32:32,273 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.73s ago] {}
2025-03-14 19:32:32,711 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:32:32,712 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:32:32,712 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:32:32,713 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:32:32,714 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.74s ago] {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}
2025-03-14 19:32:32,930 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:32:32,930 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 2 resultados
2025-03-14 19:32:32,931 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:32:32,933 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.7s ago] {'texto_search': '%5010%', 'texto_search_exato': '5010', 'texto_search_inicio': '5010%', 'limit': 20}
2025-03-14 19:32:33,148 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:32:33,149 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:32:33,149 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:32:33,150 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:32:33,151 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:47:56,806 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:47:56,807 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:47:56,856 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:47:57,816 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:47:57,817 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:47:57,848 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:47:57,967 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:47:57,997 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:47:57,997 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:47:57,997 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:47:57,997 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:47:57,998 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:47:57,998 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:47:58,592 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 19:47:58,804 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:47:58,805 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 19:47:58,806 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 945.7s ago] {'limit': 500, 'skip': 0}
2025-03-14 19:47:59,554 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:47:59,557 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:47:59,558 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:47:59,558 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:47:59,558 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:47:59,559 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 19:47:59,560 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 945.7s ago] {}
2025-03-14 19:47:59,776 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:47:59,776 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:47:59,777 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:47:59,778 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:00,330 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:48:00,330 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:00,767 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:48:00,768 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:01,207 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:48:01,207 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:01,651 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:01,652 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:48:01,653 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 19:48:02,116 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:48:07,813 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 19:48:08,027 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:08,028 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 19:48:08,028 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 955s ago] {'limit': 500, 'skip': 0}
2025-03-14 19:48:08,789 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:08,794 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:08,795 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:08,795 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:08,796 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:08,796 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 19:48:08,797 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954.9s ago] {}
2025-03-14 19:48:09,011 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:48:09,012 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:48:09,013 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:48:09,013 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:11,413 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 19:48:11,414 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 19:48:11,627 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:11,628 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:48:11,629 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954.1s ago] {}
2025-03-14 19:48:12,061 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:48:12,061 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:48:12,062 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:48:12,062 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:48:12,063 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954.1s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 19:48:12,282 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:48:12,283 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:48:12,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954.1s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 19:48:12,502 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:48:12,503 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:48:12,504 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954s ago] {}
2025-03-14 19:48:12,718 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:48:12,720 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:48:12,720 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:48:12,721 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:48:12,723 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:14,829 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 19:48:14,830 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 19:48:15,043 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:15,044 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:48:15,045 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 957.5s ago] {}
2025-03-14 19:48:15,486 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:48:15,486 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:48:15,486 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:48:15,487 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:48:15,488 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 957.5s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 19:48:15,704 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:48:15,704 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:48:15,705 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 957.5s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 19:48:15,920 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:48:15,921 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 19:48:15,921 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 954s ago] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 19:48:16,135 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 19:48:16,136 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:48:16,137 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 957.6s ago] {}
2025-03-14 19:48:16,352 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:48:16,353 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:48:16,354 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:48:16,354 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:48:16,356 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:19,085 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 19:48:19,085 - MultasGO - INFO - [search_service.py:116] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 19:48:19,296 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:19,297 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:48:19,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 961.8s ago] {}
2025-03-14 19:48:19,745 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:48:19,746 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:48:19,747 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:48:19,747 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:48:19,749 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 961.5s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 19:48:19,965 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 1 resultados novos
2025-03-14 19:48:19,966 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:48:19,966 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 961.5s ago] {}
2025-03-14 19:48:20,186 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:48:20,187 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:48:20,187 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:48:20,188 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:48:20,190 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:53,843 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:48:53,844 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:48:53,875 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:48:54,799 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:48:54,800 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:48:54,836 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:48:54,953 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:48:54,985 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:48:55,277 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 19:48:55,492 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:55,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 19:48:55,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1002s ago] {'limit': 500, 'skip': 0}
2025-03-14 19:48:56,243 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:56,246 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:56,246 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:56,246 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:56,247 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 19:48:56,247 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 19:48:56,248 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1002s ago] {}
2025-03-14 19:48:56,476 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:48:56,477 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:48:56,477 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:48:56,477 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:48:57,239 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:48:57,240 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:57,691 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:48:57,691 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:58,125 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:48:58,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:48:58,578 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:48:58,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:48:58,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00061s] {}
2025-03-14 19:48:59,013 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 19:49:03,014 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 19:49:03,014 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 19:49:03,233 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:49:03,234 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:49:03,234 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1006s ago] {}
2025-03-14 19:49:03,673 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:49:03,674 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:49:03,674 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:49:03,675 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:49:03,676 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1006s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 19:49:03,893 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:49:03,893 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:49:03,894 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1006s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 19:49:04,108 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:49:04,108 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 19:49:04,109 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1002s ago] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 19:49:04,368 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 19:49:04,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:49:04,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1006s ago] {}
2025-03-14 19:49:04,583 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:49:04,584 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:49:04,584 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:49:04,584 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:49:04,586 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:49:16,517 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '5010-0', skip=0, limit=10
2025-03-14 19:49:16,517 - MultasGO - INFO - [search_service.py:116] - Busca original: '5010-0', normalizada: '5010 0', código extraído: '50100'
2025-03-14 19:49:16,731 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:49:16,731 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:49:16,732 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1019s ago] {}
2025-03-14 19:49:17,161 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:49:17,161 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:49:17,162 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:49:17,162 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 19:49:17,163 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1019s ago] {'codigo_exato': '50100', 'codigo_inicio': '50100%', 'codigo_parcial': '%50100%', 'codigo_sem_hifen': '50100', 'limit': 20}
2025-03-14 19:49:17,390 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 19:49:17,390 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:49:17,391 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1019s ago] {'texto_search': '%5010 0%', 'texto_search_exato': '5010 0', 'texto_search_inicio': '5010 0%', 'limit': 20}
2025-03-14 19:49:17,605 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 19:49:17,605 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 19:49:17,606 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1016s ago] {'palavra_search': '%5010%', 'limit': 10}
2025-03-14 19:49:17,818 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '5010' encontrou 0 resultados novos
2025-03-14 19:49:17,819 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 19:49:17,819 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1019s ago] {}
2025-03-14 19:49:18,032 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 19:49:18,033 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 19:49:18,033 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 19:49:18,034 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 19:49:18,035 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:49:25,229 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 19:49:25,229 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 19:49:25,430 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:49:25,430 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:49:25,431 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1028s ago] {}
2025-03-14 19:49:25,823 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:49:25,823 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:49:25,824 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:49:25,824 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:49:25,825 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1028s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 19:49:26,028 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 19:49:26,029 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:49:26,030 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:49:26,030 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:49:26,030 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:49:30,133 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 19:49:30,133 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 19:49:30,331 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:49:30,331 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 19:49:30,332 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1033s ago] {}
2025-03-14 19:49:30,724 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 19:49:30,724 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 19:49:30,724 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 19:49:30,725 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 19:49:30,725 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1032s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 19:49:30,927 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 19:49:30,928 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 19:49:30,928 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 19:49:30,929 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 19:49:30,929 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 19:58:42,480 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 19:58:42,480 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 19:58:42,514 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 19:58:42,638 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 19:58:42,663 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 19:58:42,664 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 19:58:42,664 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 19:58:42,664 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 19:58:42,664 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 19:58:42,664 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 19:58:44,862 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 19:58:44,863 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:58:45,272 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 19:58:45,272 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:58:45,697 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 19:58:45,697 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 19:58:46,101 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 19:58:46,102 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 19:58:46,103 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00072s] {}
2025-03-14 19:58:46,520 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:03:42,936 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:03:42,936 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:03:42,969 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:03:43,094 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:03:43,128 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:03:43,128 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:03:43,128 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:03:43,128 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:03:43,129 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:03:43,129 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:03:45,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:03:45,574 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:03:46,011 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:03:46,012 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:03:46,457 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:03:46,458 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:03:46,890 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:03:46,891 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:03:46,892 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 20:03:47,330 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:08:43,479 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:08:43,480 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:08:43,512 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:08:43,644 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:08:43,672 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:08:43,672 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:08:43,673 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:08:43,673 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:08:43,673 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:08:43,674 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:08:45,844 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:08:45,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:08:46,248 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:08:46,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:08:46,658 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:08:46,659 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:08:47,058 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:08:47,059 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:08:47,059 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 20:08:47,458 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:10:23,144 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:10:23,145 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:10:23,176 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:10:23,280 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:10:23,307 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:10:25,409 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:10:25,410 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:25,807 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:10:25,808 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:26,203 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:10:26,204 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:26,600 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:26,601 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:10:26,602 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00076s] {}
2025-03-14 20:10:26,995 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:10:30,493 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:10:30,494 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:10:30,524 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:10:31,532 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:10:31,533 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:10:31,566 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:10:31,680 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:10:31,710 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:10:31,710 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:10:31,710 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:10:31,710 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:10:31,710 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:10:31,711 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:10:32,253 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 20:10:32,467 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:32,467 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 20:10:32,468 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2299s ago] {'limit': 500, 'skip': 0}
2025-03-14 20:10:33,212 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:10:33,217 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:10:33,218 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:10:33,218 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:10:33,218 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:10:33,218 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 20:10:33,218 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2299s ago] {}
2025-03-14 20:10:33,432 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 20:10:33,432 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 20:10:33,433 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 20:10:33,433 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:10:33,960 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:10:33,960 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:34,392 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:10:34,393 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:34,829 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:10:34,830 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:10:35,265 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:35,266 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:10:35,266 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00080s] {}
2025-03-14 20:10:35,708 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:10:39,834 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 20:10:39,835 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 20:10:40,052 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:40,054 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:10:40,054 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2303s ago] {}
2025-03-14 20:10:40,492 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:10:40,492 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:10:40,493 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:10:40,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:10:40,494 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2303s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 20:10:40,712 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:10:40,712 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:10:40,712 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2302s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 20:10:40,927 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:10:40,928 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:10:40,928 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2302s ago] {}
2025-03-14 20:10:41,142 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:10:41,143 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:10:41,144 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:10:41,144 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:10:41,146 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:10:44,458 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 20:10:44,458 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 20:10:44,672 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:44,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:10:44,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2307s ago] {}
2025-03-14 20:10:45,122 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:10:45,123 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:10:45,123 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:10:45,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:10:45,124 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2307s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 20:10:45,349 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:10:45,350 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:10:45,350 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2307s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 20:10:45,579 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:10:45,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 20:10:45,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2304s ago] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 20:10:45,795 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 20:10:45,795 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:10:45,796 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2307s ago] {}
2025-03-14 20:10:46,010 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:10:46,011 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:10:46,011 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:10:46,011 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:10:46,013 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:10:48,912 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 20:10:48,912 - MultasGO - INFO - [search_service.py:116] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 20:10:49,141 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:10:49,142 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:10:49,142 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2312s ago] {}
2025-03-14 20:10:49,578 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:10:49,579 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:10:49,579 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:10:49,579 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:10:49,580 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2311s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 20:10:49,800 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 1 resultados novos
2025-03-14 20:10:49,800 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:10:49,801 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2311s ago] {}
2025-03-14 20:10:50,016 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:10:50,017 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:10:50,017 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:10:50,017 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:10:50,019 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:13:03,063 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:13:03,064 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:13:03,099 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:13:03,169 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 20:13:05,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:13:05,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:13:06,036 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:13:06,037 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:13:06,502 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:13:06,503 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:13:06,972 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:13:06,973 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:06,974 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 20:13:07,427 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:07,428 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:07,429 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:07,429 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:13:07,430 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00072s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 20:13:07,680 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:13:07,681 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:07,682 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00097s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 20:13:07,904 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:13:07,905 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:13:07,906 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00055s] {}
2025-03-14 20:13:08,166 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 20:13:08,168 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:08,169 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.196s ago] {}
2025-03-14 20:13:08,406 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:08,406 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:08,407 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:08,408 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:13:08,408 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.9793s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 20:13:08,630 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:13:08,631 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:08,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.9506s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 20:13:08,850 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:13:08,850 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 20:13:08,851 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00080s] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 20:13:09,072 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 20:13:09,073 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:13:09,074 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168s ago] {}
2025-03-14 20:13:09,301 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 20:13:09,301 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:09,302 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.328s ago] {}
2025-03-14 20:13:09,532 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:09,533 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:09,533 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:09,534 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:09,534 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.853s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 20:13:09,776 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 20:13:09,779 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 20:13:09,779 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:09,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.806s ago] {}
2025-03-14 20:13:09,996 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:09,997 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:09,997 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:09,998 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:09,999 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.318s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 20:13:10,224 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 20:13:10,227 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacion', normalizada: 'estacion', código extraído: ''
2025-03-14 20:13:10,228 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:10,228 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.255s ago] {}
2025-03-14 20:13:10,447 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:10,448 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:10,448 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:10,449 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:10,450 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.768s ago] {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}
2025-03-14 20:13:10,671 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 20:13:10,673 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estaconar', normalizada: 'estaconar', código extraído: ''
2025-03-14 20:13:10,674 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:10,675 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.701s ago] {}
2025-03-14 20:13:10,898 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:10,899 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:10,900 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:10,901 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:10,902 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.22s ago] {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}
2025-03-14 20:13:11,121 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:13:11,122 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:11,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00088s] {'termo_search': '%estacionar%', 'limit': 10}
2025-03-14 20:13:11,363 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'estacionar' encontrou 10 resultados novos
2025-03-14 20:13:11,364 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:11,365 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.2421s ago] {'termo_search': '%estacionamento%', 'limit': 10}
2025-03-14 20:13:11,588 - MultasGO - WARNING - [search_service.py:477] - Erro ao converter pontos: Não há
2025-03-14 20:13:11,588 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'estacionamento' encontrou 3 resultados novos
2025-03-14 20:13:11,588 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:11,589 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.4673s ago] {'termo_search': '%parado%', 'limit': 10}
2025-03-14 20:13:11,861 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'parado' encontrou 10 resultados novos
2025-03-14 20:13:11,864 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:11,867 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.7445s ago] {'termo_search': '%parar%', 'limit': 10}
2025-03-14 20:13:12,094 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'parar' encontrou 10 resultados novos
2025-03-14 20:13:12,095 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:12,096 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.974s ago] {'termo_search': '%vaga%', 'limit': 10}
2025-03-14 20:13:12,338 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'vaga' encontrou 5 resultados novos
2025-03-14 20:13:12,339 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 20:13:12,340 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.217s ago] {'termo_search': '%estacionado%', 'limit': 10}
2025-03-14 20:13:12,560 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'estacionado' encontrou 1 resultados novos
2025-03-14 20:13:12,563 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidad', normalizada: 'velocidad', código extraído: ''
2025-03-14 20:13:12,564 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:12,564 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.59s ago] {}
2025-03-14 20:13:12,928 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:12,929 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:12,930 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:12,930 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:12,931 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.25s ago] {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}
2025-03-14 20:13:13,197 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 20:13:13,199 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 20:13:13,200 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:13,200 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6.226s ago] {}
2025-03-14 20:13:13,422 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:13:13,423 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:13:13,423 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:13:13,424 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:13,425 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.743s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 20:13:13,647 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:13:13,648 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:13:13,649 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.743s ago] {}
2025-03-14 20:13:13,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        
2025-03-14 20:13:13,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00098s] {}
2025-03-14 20:13:14,135 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-14 20:13:14,140 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 389, in pesquisar_infracoes
    result_populares = db.execute(text(sql_populares))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-14 20:13:14,142 - MultasGO - INFO - [search_service.py:116] - Busca original: '5010', normalizada: '5010', código extraído: '5010'
2025-03-14 20:13:14,142 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:14,143 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.169s ago] {}
2025-03-14 20:13:14,367 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:14,368 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:13:14,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:13:14,370 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6.94s ago] {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}
2025-03-14 20:13:14,590 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:14,592 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:13:14,595 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 20:13:14,595 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:14,595 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.621s ago] {}
2025-03-14 20:13:14,858 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:14,858 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:13:14,859 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:13:14,860 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.431s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 20:13:15,180 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:15,181 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:13:15,184 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 20:13:15,185 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00065s] {'limit': 10, 'skip': 0}
2025-03-14 20:13:15,410 - MultasGO - ERROR - [search_service.py:531] - Erro ao buscar todos: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        ]
[parameters: {'limit': 10, 'skip': 0}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:15,413 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xyzabcdefg', normalizada: 'xyzabcdefg', código extraído: ''
2025-03-14 20:13:15,413 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:13:15,414 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8.44s ago] {}
2025-03-14 20:13:15,649 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:15,649 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:13:15,650 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:13:15,651 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7.97s ago] {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}
2025-03-14 20:13:15,879 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:13:15,880 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:13:16,210 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:23:34,105 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:23:34,106 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:23:34,149 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:23:35,461 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:23:35,461 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:23:35,498 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:23:35,634 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:23:35,673 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:23:35,673 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:23:35,674 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:23:35,674 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:23:35,674 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:23:35,674 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:23:35,723 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 20:23:35,924 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:23:35,925 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 20:23:35,926 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3083s ago] {'limit': 500, 'skip': 0}
2025-03-14 20:23:36,622 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:23:36,625 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:23:36,626 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:23:36,626 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:23:36,626 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:23:36,626 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 20:23:36,627 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3083s ago] {}
2025-03-14 20:23:36,828 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 20:23:36,828 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    codigo=item.get("codigo", ""),
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 20:23:36,829 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 20:23:36,829 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:23:37,871 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:23:37,872 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:23:38,307 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:23:38,308 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:23:38,730 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:23:38,731 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:23:39,133 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:23:39,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:23:39,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00071s] {}
2025-03-14 20:23:39,548 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:43:09,999 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:43:10,000 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:43:10,036 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:43:38,114 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:43:38,115 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:43:38,146 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:46:23,270 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:46:23,270 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:46:23,305 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:46:24,502 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:46:24,503 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:46:24,537 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:46:24,700 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 20:46:24,741 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 20:46:24,741 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 20:46:24,741 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 20:46:24,741 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 20:46:24,741 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 20:46:24,742 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 20:46:25,068 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 20:46:26,561 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:46:26,561 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 20:46:26,562 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4454s ago] {'limit': 500, 'skip': 0}
2025-03-14 20:46:27,114 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:46:27,114 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:46:27,253 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:46:27,256 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:46:27,257 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:46:27,257 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:46:27,257 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 20:46:27,258 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 20:46:27,258 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4453s ago] {}
2025-03-14 20:46:27,461 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 20:46:27,462 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    "Órgão Autuador" as orgao_autuador,
         ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 20:46:27,462 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 20:46:27,463 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:46:27,540 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:46:27,541 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:46:27,967 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:46:27,968 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:46:28,386 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:46:28,388 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 20:46:28,388 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00057s] {}
2025-03-14 20:46:28,790 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 20:46:32,925 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 20:46:32,925 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 20:46:33,122 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:46:33,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:46:33,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4456s ago] {}
2025-03-14 20:46:33,532 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:46:33,533 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:46:33,534 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:46:33,534 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:46:33,535 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4456s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 20:46:33,735 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:46:33,736 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:46:33,736 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4456s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 20:46:33,934 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:46:33,934 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:46:33,935 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4455s ago] {}
2025-03-14 20:46:34,133 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:46:34,134 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:46:34,135 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:46:34,135 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:46:34,137 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:46:43,061 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 20:46:43,061 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 20:46:43,268 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:46:43,269 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:46:43,269 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4466s ago] {}
2025-03-14 20:46:43,664 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:46:43,664 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:46:43,665 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:46:43,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:46:43,666 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4466s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 20:46:43,863 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 20:46:43,864 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:46:43,864 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4466s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 20:46:44,070 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:46:44,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 20:46:44,072 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4462s ago] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 20:46:44,273 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 20:46:44,274 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:46:44,274 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4466s ago] {}
2025-03-14 20:46:44,475 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:46:44,477 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:46:44,477 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:46:44,477 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:46:44,479 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:46:47,732 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 20:46:47,732 - MultasGO - INFO - [search_service.py:116] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 20:46:47,939 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:46:47,940 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:46:47,940 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4470s ago] {}
2025-03-14 20:46:48,342 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:46:48,343 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:46:48,343 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:46:48,344 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:46:48,344 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4470s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 20:46:48,552 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 1 resultados novos
2025-03-14 20:46:48,553 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:46:48,554 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4470s ago] {}
2025-03-14 20:46:48,753 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 20:46:48,754 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 20:46:48,754 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 20:46:48,754 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 20:46:48,756 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 20:47:18,093 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 20:47:18,094 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 20:47:18,126 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 20:47:18,202 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 20:47:20,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 20:47:20,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:47:20,833 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 20:47:20,834 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:47:21,245 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 20:47:21,246 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 20:47:21,650 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 20:47:21,651 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:21,652 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00084s] {}
2025-03-14 20:47:22,047 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 20:47:22,048 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 20:47:22,049 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 20:47:22,049 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:47:22,050 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00108s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 20:47:22,262 - MultasGO - ERROR - [search_service.py:484] - Erro ao processar linha: name 'infracao' is not defined
2025-03-14 20:47:22,263 - MultasGO - DEBUG - [search_service.py:485] - Detalhes da linha: (75790, 'Recusar-se a ser submetido a teste, exame clínico, perícia ou outro procedimento que permita certificar influência de álcool ou outra substância psicoativa, na forma estabelecida pelo art. 277 ', 'Condutor ', '2934.7', 'Estadual/Rodoviário ', '165-A ', '7.0', 'gravíssima10x')
2025-03-14 20:47:22,263 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 0 resultados
2025-03-14 20:47:22,264 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:22,265 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00095s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 20:47:22,482 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 20:47:22,483 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 20:47:22,484 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00111s] {}
2025-03-14 20:47:22,697 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        
2025-03-14 20:47:22,697 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00093s] {}
2025-03-14 20:47:22,897 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-14 20:47:22,951 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 389, in pesquisar_infracoes
    result_populares = db.execute(text(sql_populares))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-14 20:47:22,953 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 20:47:22,954 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:22,954 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.304s ago] {}
2025-03-14 20:47:23,155 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:23,155 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:23,156 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:47:23,157 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.107s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 20:47:23,367 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:23,369 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:23,372 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 20:47:23,372 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:23,373 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.721s ago] {}
2025-03-14 20:47:23,574 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:23,574 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:23,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:23,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.312s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 20:47:23,773 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:23,775 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:23,777 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 20:47:23,778 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:23,778 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.127s ago] {}
2025-03-14 20:47:23,985 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:23,986 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:23,986 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:23,987 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.723s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 20:47:24,194 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:24,195 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:24,198 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacion', normalizada: 'estacion', código extraído: ''
2025-03-14 20:47:24,198 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:24,198 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.547s ago] {}
2025-03-14 20:47:24,407 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:24,407 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:24,408 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:24,409 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.146s ago] {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}
2025-03-14 20:47:24,607 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:24,609 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:24,611 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estaconar', normalizada: 'estaconar', código extraído: ''
2025-03-14 20:47:24,612 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:24,613 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.961s ago] {}
2025-03-14 20:47:24,809 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:24,810 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:24,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:24,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.548s ago] {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}
2025-03-14 20:47:25,010 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:25,012 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:25,014 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidad', normalizada: 'velocidad', código extraído: ''
2025-03-14 20:47:25,015 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:25,015 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.364s ago] {}
2025-03-14 20:47:25,214 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:25,215 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:25,216 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:25,217 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.953s ago] {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}
2025-03-14 20:47:25,443 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:25,445 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:25,448 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 20:47:25,448 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:25,449 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.798s ago] {}
2025-03-14 20:47:25,645 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:25,645 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:25,646 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:25,647 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.384s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 20:47:25,845 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:25,847 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:25,849 - MultasGO - INFO - [search_service.py:116] - Busca original: '5010', normalizada: '5010', código extraído: '5010'
2025-03-14 20:47:25,850 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:25,850 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.199s ago] {}
2025-03-14 20:47:26,049 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:26,049 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:26,050 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:47:26,051 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.001s ago] {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}
2025-03-14 20:47:26,248 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:26,250 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:26,252 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 20:47:26,253 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:26,254 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.602s ago] {}
2025-03-14 20:47:26,460 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:26,460 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:26,461 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 20:47:26,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.413s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 20:47:26,674 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:26,675 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:26,678 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 20:47:26,679 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00082s] {'limit': 10, 'skip': 0}
2025-03-14 20:47:26,876 - MultasGO - ERROR - [search_service.py:523] - Erro ao buscar todos: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        ]
[parameters: {'limit': 10, 'skip': 0}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:26,878 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xyzabcdefg', normalizada: 'xyzabcdefg', código extraído: ''
2025-03-14 20:47:26,879 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 20:47:26,879 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.228s ago] {}
2025-03-14 20:47:27,075 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:27,075 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 20:47:27,076 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 20:47:27,077 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.813s ago] {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}
2025-03-14 20:47:27,280 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 20:47:27,282 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 20:47:27,522 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:05:18,596 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:05:18,596 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:05:18,637 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:05:18,736 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:05:20,938 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 21:05:20,939 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:05:21,344 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 21:05:21,345 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:05:21,752 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 21:05:21,752 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:05:22,143 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:05:22,144 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:22,145 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00085s] {}
2025-03-14 21:05:22,541 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:05:22,541 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:05:22,542 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:05:22,543 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:05:22,543 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00075s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:05:22,746 - MultasGO - ERROR - [search_service.py:484] - Erro ao processar linha: name 'infracao' is not defined
2025-03-14 21:05:22,747 - MultasGO - DEBUG - [search_service.py:485] - Detalhes da linha: (75790, 'Recusar-se a ser submetido a teste, exame clínico, perícia ou outro procedimento que permita certificar influência de álcool ou outra substância psicoativa, na forma estabelecida pelo art. 277 ', 'Condutor ', '2934.7', 'Estadual/Rodoviário ', '165-A ', '7.0', 'gravíssima10x')
2025-03-14 21:05:22,747 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 0 resultados
2025-03-14 21:05:22,748 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:22,749 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00115s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:05:22,950 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:05:22,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:05:22,951 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00093s] {}
2025-03-14 21:05:23,150 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        
2025-03-14 21:05:23,150 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00094s] {}
2025-03-14 21:05:23,367 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-14 21:05:23,372 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 389, in pesquisar_infracoes
    result_populares = db.execute(text(sql_populares))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-14 21:05:23,374 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 21:05:23,375 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:23,375 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.23s ago] {}
2025-03-14 21:05:23,571 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:23,572 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:23,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:05:23,574 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.031s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:05:23,775 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:23,777 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:23,779 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:05:23,779 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:23,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.635s ago] {}
2025-03-14 21:05:23,978 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:23,978 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:23,979 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:23,979 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.232s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:05:24,179 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:24,181 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:24,184 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 21:05:24,184 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:24,185 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.04s ago] {}
2025-03-14 21:05:24,384 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:24,385 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:24,387 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:24,387 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.64s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 21:05:24,587 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:24,589 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:24,591 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacion', normalizada: 'estacion', código extraído: ''
2025-03-14 21:05:24,591 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:24,592 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.448s ago] {}
2025-03-14 21:05:24,789 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:24,790 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:24,790 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:24,792 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.044s ago] {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}
2025-03-14 21:05:24,992 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:24,994 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estacion%', 'texto_search_exato': 'estacion', 'texto_search_inicio': 'estacion%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:24,995 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estaconar', normalizada: 'estaconar', código extraído: ''
2025-03-14 21:05:24,996 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:24,996 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.852s ago] {}
2025-03-14 21:05:25,210 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:25,211 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:25,212 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:25,213 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.465s ago] {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}
2025-03-14 21:05:25,414 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:25,415 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%estaconar%', 'texto_search_exato': 'estaconar', 'texto_search_inicio': 'estaconar%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:25,418 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidad', normalizada: 'velocidad', código extraído: ''
2025-03-14 21:05:25,418 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:25,419 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.274s ago] {}
2025-03-14 21:05:25,616 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:25,617 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:25,617 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:25,618 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2.87s ago] {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}
2025-03-14 21:05:25,818 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:25,819 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%velocidad%', 'texto_search_exato': 'velocidad', 'texto_search_inicio': 'velocidad%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:25,822 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 21:05:25,822 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:25,823 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.678s ago] {}
2025-03-14 21:05:26,021 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:26,022 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:26,022 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:26,023 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.276s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 21:05:26,227 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:26,228 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:26,231 - MultasGO - INFO - [search_service.py:116] - Busca original: '5010', normalizada: '5010', código extraído: '5010'
2025-03-14 21:05:26,231 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:26,232 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.088s ago] {}
2025-03-14 21:05:26,436 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:26,437 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:26,438 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:05:26,438 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.896s ago] {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}
2025-03-14 21:05:26,636 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:26,638 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:26,640 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:05:26,640 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:26,641 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.497s ago] {}
2025-03-14 21:05:26,844 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:26,844 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:26,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:05:26,846 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.303s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:05:27,042 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:27,044 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 147, in pesquisar_infracoes
    result_codigo = db.execute(
                    ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            ]
[parameters: {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:27,047 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 21:05:27,048 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00080s] {'limit': 10, 'skip': 0}
2025-03-14 21:05:27,248 - MultasGO - ERROR - [search_service.py:523] - Erro ao buscar todos: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        ]
[parameters: {'limit': 10, 'skip': 0}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:27,249 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xyzabcdefg', normalizada: 'xyzabcdefg', código extraído: ''
2025-03-14 21:05:27,250 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:05:27,251 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5.106s ago] {}
2025-03-14 21:05:27,451 - MultasGO - ERROR - [search_service.py:71] - Erro no diagnóstico de banco: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:27,451 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 0 registros de exemplo
2025-03-14 21:05:27,452 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:05:27,453 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.705s ago] {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}
2025-03-14 21:05:27,659 - MultasGO - ERROR - [search_service.py:420] - Erro ao pesquisar infrações: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-03-14 21:05:27,661 - MultasGO - ERROR - [search_service.py:421] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 189, in pesquisar_infracoes
    result_texto = db.execute(
                   ^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        ]
[parameters: {'texto_search': '%xyzabcdefg%', 'texto_search_exato': 'xyzabcdefg', 'texto_search_inicio': 'xyzabcdefg%', 'limit': 20}]
(Background on this error at: https://sqlalche.me/e/20/2j85)

2025-03-14 21:05:27,882 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:10:06,407 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:10:06,408 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:10:06,442 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:10:07,409 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:10:07,409 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:10:07,447 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:10:07,573 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 21:10:07,607 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 21:10:07,607 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 21:10:07,607 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 21:10:07,608 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 21:10:07,608 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 21:10:07,608 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 21:10:08,255 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=500
2025-03-14 21:10:08,504 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:08,504 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 21:10:08,505 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5875s ago] {'limit': 500, 'skip': 0}
2025-03-14 21:10:09,195 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:10:09,200 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:10:09,201 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:10:09,201 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:10:09,202 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:10:09,202 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 21:10:09,203 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5875s ago] {}
2025-03-14 21:10:09,405 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:10:09,406 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    "Órgão Autuador" as orgao_autuador,
         ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:10:09,407 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:10:09,407 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:10:09,940 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 21:10:09,941 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:10:10,351 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 21:10:10,352 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:10:10,779 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 21:10:10,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:10:11,189 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:11,190 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:10:11,191 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 21:10:11,561 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:10:11,562 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:10:11,602 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 21:10:11,769 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:11,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:10:11,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5874s ago] {}
2025-03-14 21:10:12,212 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:10:12,213 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:10:12,213 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:10:12,213 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:10:12,214 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5874s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:10:12,417 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:10:12,417 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:10:12,418 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5874s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:10:12,621 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:10:12,622 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:10:12,622 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5874s ago] {}
2025-03-14 21:10:12,820 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:10:12,821 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:10:12,822 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:10:12,822 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:10:12,825 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:10:14,601 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 21:10:14,601 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 21:10:14,798 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:14,799 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:10:14,799 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5877s ago] {}
2025-03-14 21:10:15,202 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:10:15,203 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:10:15,203 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:10:15,203 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:10:15,204 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5877s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:10:15,414 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:10:15,415 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:10:15,416 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5877s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 21:10:15,631 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:10:15,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 21:10:15,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5874s ago] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 21:10:15,830 - MultasGO - INFO - [search_service.py:239] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 21:10:15,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:10:15,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5877s ago] {}
2025-03-14 21:10:16,031 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:10:16,031 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:10:16,032 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:10:16,032 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:10:16,034 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:10:18,144 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 21:10:18,144 - MultasGO - INFO - [search_service.py:116] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 21:10:18,356 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:18,357 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:10:18,357 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5881s ago] {}
2025-03-14 21:10:18,766 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:10:18,767 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:10:18,767 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:10:18,767 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:10:18,768 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5881s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 21:10:18,972 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 1 resultados novos
2025-03-14 21:10:18,972 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:10:18,973 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5880s ago] {}
2025-03-14 21:10:19,178 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:10:19,179 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:10:19,179 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:10:19,179 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:10:19,181 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:10:21,240 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 21:10:21,240 - MultasGO - INFO - [search_service.py:116] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 21:10:21,478 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:10:21,479 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:10:21,480 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5884s ago] {}
2025-03-14 21:10:21,889 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:10:21,889 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:10:21,890 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:10:21,890 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:10:21,891 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5884s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 21:10:22,091 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:10:22,092 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:10:22,093 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5884s ago] {}
2025-03-14 21:10:22,311 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:10:22,312 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:10:22,312 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:10:22,312 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:10:22,314 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:11:21,763 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:11:21,763 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:11:21,959 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:11:21,960 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:11:21,961 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5944s ago] {}
2025-03-14 21:11:22,358 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:11:22,358 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:11:22,359 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:11:22,359 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:11:22,360 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5944s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:11:22,561 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:11:22,562 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:11:22,562 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5944s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:11:22,762 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:11:22,763 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:11:22,763 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 5944s ago] {}
2025-03-14 21:11:22,962 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:11:22,962 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:11:22,963 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:11:22,963 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:11:22,965 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:16:43,596 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=10
2025-03-14 21:16:43,803 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:16:43,803 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 21:16:43,804 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6271s ago] {'limit': 10, 'skip': 0}
2025-03-14 21:16:44,205 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:16:44,206 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 21:16:44,206 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6270s ago] {}
2025-03-14 21:16:44,413 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:16:44,413 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    "Órgão Autuador" as orgao_autuador,
         ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:16:44,414 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:16:44,414 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:18:42,792 - MultasGO - INFO - [infracoes.py:28] - Listando infrações com skip=0, limit=10
2025-03-14 21:18:42,989 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:18:42,990 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        ORDER BY "Código de Infração" ASC
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 21:18:42,990 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6390s ago] {'limit': 10, 'skip': 0}
2025-03-14 21:18:43,400 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:18:43,401 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 21:18:43,401 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6390s ago] {}
2025-03-14 21:18:43,609 - MultasGO - ERROR - [infracoes.py:59] - Erro ao listar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:18:43,610 - MultasGO - ERROR - [infracoes.py:60] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 38, in listar_infracoes
    "Órgão Autuador" as orgao_autuador,
         ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:18:43,611 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:18:43,611 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:18:50,726 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:18:50,726 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:18:50,932 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:18:50,933 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:18:50,933 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6393s ago] {}
2025-03-14 21:18:51,352 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:18:51,352 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:18:51,353 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:18:51,353 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:18:51,354 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6393s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:18:51,561 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:18:51,561 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:18:51,562 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6393s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:18:51,768 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:18:51,769 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:18:51,769 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6393s ago] {}
2025-03-14 21:18:51,967 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:18:51,968 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:18:51,969 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:18:51,969 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:18:51,971 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:23:44,793 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:23:44,793 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:23:45,008 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:23:45,009 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:23:45,009 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6687s ago] {}
2025-03-14 21:23:45,440 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:23:45,440 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:23:45,441 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:23:45,441 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:23:45,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6687s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:23:45,659 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:23:45,659 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:23:45,660 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6687s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:23:45,877 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:23:45,878 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:23:45,879 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6687s ago] {}
2025-03-14 21:23:46,095 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:23:46,096 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:23:46,097 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:23:46,097 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:23:46,099 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:23:54,999 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:23:55,000 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:23:55,214 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:23:55,215 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:23:55,216 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6698s ago] {}
2025-03-14 21:23:55,650 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:23:55,650 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:23:55,652 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:23:55,652 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:23:55,652 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6698s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:23:55,877 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:23:55,877 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:23:55,878 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6698s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:23:56,099 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:23:56,099 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:23:56,100 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6698s ago] {}
2025-03-14 21:23:56,326 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:23:56,328 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:23:56,328 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:23:56,328 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:23:56,330 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:24:37,476 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:24:37,537 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:24:37,539 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:24:37,654 - MultasGO - ERROR - [search_service.py:495] - Erro ao processar linha: 0
2025-03-14 21:24:37,654 - MultasGO - DEBUG - [search_service.py:496] - Detalhes da linha: {'Código de Infração': '7579', 'Infração': 'Teste de infração', 'Responsável': 'Condutor', 'Valor da Multa': '100.0', 'Órgão Autuador': 'DETRAN', 'Artigos do CTB': 'Art. 123', 'pontos': '3', 'gravidade': 'Leve'}
2025-03-14 21:25:15,898 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:25:15,899 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:25:16,112 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:25:16,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:25:16,113 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6779s ago] {}
2025-03-14 21:25:16,548 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:25:16,548 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:25:16,549 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:25:16,549 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:25:16,550 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6779s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:25:16,768 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:25:16,769 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:25:16,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6779s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:25:16,985 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:25:16,987 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:25:16,987 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6778s ago] {}
2025-03-14 21:25:17,209 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:25:17,210 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:25:17,210 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:25:17,210 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:25:17,212 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:26:02,395 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:26:02,396 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:26:02,396 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6838s ago] {}
2025-03-14 21:26:04,896 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:26:04,896 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:26:06,779 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:26:06,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:26:06,781 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6829s ago] {}
2025-03-14 21:26:07,241 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:26:07,241 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:26:07,242 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:26:07,242 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:26:07,242 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6829s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:26:07,457 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:26:07,457 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:26:07,458 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6829s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:26:07,664 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:26:07,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:26:07,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6829s ago] {}
2025-03-14 21:26:07,874 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:26:07,876 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:26:07,876 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:26:07,876 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:26:07,878 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:26:15,091 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:26:15,091 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:26:15,298 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:26:15,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:26:15,299 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6838s ago] {}
2025-03-14 21:26:15,728 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:26:15,728 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:26:15,729 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:26:15,729 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:26:15,730 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6838s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:26:15,938 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:26:15,939 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:26:15,939 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:26:15,940 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:26:15,941 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:27:44,519 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:27:44,519 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:27:44,745 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:27:44,745 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:27:44,746 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6927s ago] {}
2025-03-14 21:27:45,180 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:27:45,180 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:27:45,181 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:27:45,181 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:27:45,182 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6927s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:27:45,420 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:27:45,420 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:27:45,421 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6927s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:27:45,642 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:27:45,643 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:27:45,643 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6927s ago] {}
2025-03-14 21:27:45,862 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:27:45,862 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # A saída de rapidfuzz.process.extract é uma lista de tuplas (match, score)
                                          ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:27:45,863 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:27:45,863 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:27:45,865 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:28:50,147 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:28:50,148 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:28:50,200 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:28:52,324 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 21:28:52,325 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:28:52,731 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 21:28:52,732 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:28:53,145 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 21:28:53,146 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:28:53,567 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:28:53,568 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:28:53,569 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00209s] {}
2025-03-14 21:28:53,976 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:28:54,408 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:28:54,409 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:28:54,410 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.8436s ago] {}
2025-03-14 21:28:54,820 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 21:28:54,821 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00068s] {}
2025-03-14 21:28:55,030 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT * FROM bdbautos LIMIT 1
2025-03-14 21:28:55,031 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00086s] {}
2025-03-14 21:28:55,245 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT * FROM bdbautos WHERE "Código de Infração" = %(codigo)s
2025-03-14 21:28:55,246 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00077s] {'codigo': '7579'}
2025-03-14 21:28:55,450 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT "Código de Infração" FROM bdbautos WHERE "Código de Infração" LIKE %(codigo)s LIMIT 5
2025-03-14 21:28:55,451 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00075s] {'codigo': '757%'}
2025-03-14 21:29:45,196 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:29:45,196 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:29:45,243 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:29:47,490 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 21:29:47,491 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:29:47,929 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 21:29:47,930 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:29:48,363 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 21:29:48,364 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:29:48,800 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:29:48,801 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:29:48,802 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00152s] {}
2025-03-14 21:29:49,216 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:29:49,648 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:29:49,649 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:29:49,649 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.8496s ago] {}
2025-03-14 21:29:50,076 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT COUNT(*) FROM bdbautos
2025-03-14 21:29:50,076 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00077s] {}
2025-03-14 21:29:50,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT * FROM bdbautos LIMIT 1
2025-03-14 21:29:50,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00059s] {}
2025-03-14 21:29:50,494 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT * FROM bdbautos WHERE CAST("Código de Infração" AS TEXT) = %(codigo)s
2025-03-14 21:29:50,495 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00072s] {'codigo': '7579'}
2025-03-14 21:29:50,734 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT "Código de Infração" FROM bdbautos WHERE CAST("Código de Infração" AS TEXT) LIKE %(codigo)s LIMIT 5
2025-03-14 21:29:50,735 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00051s] {'codigo': '757%'}
2025-03-14 21:29:50,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT "Código de Infração" FROM bdbautos ORDER BY "Código de Infração" LIMIT 5
2025-03-14 21:29:50,951 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00085s] {}
2025-03-14 21:29:51,167 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT * FROM bdbautos WHERE LOWER("Infração") LIKE %(texto)s LIMIT 5
2025-03-14 21:29:51,167 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00082s] {'texto': '%estacionar%'}
2025-03-14 21:36:14,582 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:36:14,582 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:36:14,794 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:14,795 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:14,796 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7437s ago] {}
2025-03-14 21:36:15,233 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:15,234 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:15,234 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:15,234 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:36:15,235 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7437s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:36:15,461 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:36:15,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:15,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7437s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:36:15,676 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:36:15,676 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:36:15,676 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7437s ago] {}
2025-03-14 21:36:15,892 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:36:15,893 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:36:15,894 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:36:15,894 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:36:15,896 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:36:17,958 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:36:17,959 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:36:18,174 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:18,175 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:18,175 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7441s ago] {}
2025-03-14 21:36:18,625 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:18,625 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:18,626 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:18,626 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:36:18,627 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7441s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:36:18,843 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:36:18,844 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:18,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7441s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:36:19,063 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:36:19,064 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:36:19,065 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7441s ago] {}
2025-03-14 21:36:19,285 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:36:19,286 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:36:19,287 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:36:19,287 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:36:19,289 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:36:21,322 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '757', skip=0, limit=10
2025-03-14 21:36:21,323 - MultasGO - INFO - [search_service.py:116] - Busca original: '757', normalizada: '757', código extraído: '757'
2025-03-14 21:36:21,546 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:21,547 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:21,547 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7444s ago] {}
2025-03-14 21:36:21,974 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:21,974 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:21,975 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:21,975 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:36:21,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7444s ago] {'codigo_exato': '757', 'codigo_inicio': '757%', 'codigo_parcial': '%757%', 'codigo_sem_hifen': '757', 'limit': 20}
2025-03-14 21:36:22,193 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 3 resultados
2025-03-14 21:36:22,195 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:22,195 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7444s ago] {'texto_search': '%757%', 'texto_search_exato': '757', 'texto_search_inicio': '757%', 'limit': 20}
2025-03-14 21:36:22,425 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:36:22,426 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:36:22,427 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:36:22,428 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:36:22,428 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:36:24,697 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:36:24,698 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:36:24,915 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:24,916 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:24,916 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7447s ago] {}
2025-03-14 21:36:25,379 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:25,380 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:25,381 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:25,397 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:25,398 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7447s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:36:25,615 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:36:25,617 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:36:25,617 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:36:25,618 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:36:25,618 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:36:27,887 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'recusa', skip=0, limit=10
2025-03-14 21:36:27,888 - MultasGO - INFO - [search_service.py:116] - Busca original: 'recusa', normalizada: 'recusa', código extraído: ''
2025-03-14 21:36:28,102 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:28,103 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:28,103 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7451s ago] {}
2025-03-14 21:36:28,537 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:28,538 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:28,538 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:28,538 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:28,539 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7450s ago] {'texto_search': '%recusa%', 'texto_search_exato': 'recusa', 'texto_search_inicio': 'recusa%', 'limit': 20}
2025-03-14 21:36:28,759 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 3 resultados novos
2025-03-14 21:36:28,761 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:28,762 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00081s] {'termo_search': '%recusa%', 'limit': 10}
2025-03-14 21:36:28,975 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusa' encontrou 3 resultados novos
2025-03-14 21:36:28,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:28,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.2159s ago] {'termo_search': '%recusar%', 'limit': 10}
2025-03-14 21:36:29,198 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusar' encontrou 2 resultados novos
2025-03-14 21:36:29,199 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:29,199 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.4386s ago] {'termo_search': '%etilometro%', 'limit': 10}
2025-03-14 21:36:29,420 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'etilometro' encontrou 0 resultados novos
2025-03-14 21:36:29,420 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:29,421 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.6597s ago] {'termo_search': '%bafometro%', 'limit': 10}
2025-03-14 21:36:29,636 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'bafometro' encontrou 0 resultados novos
2025-03-14 21:36:29,637 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:29,637 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.8765s ago] {'termo_search': '%teste%', 'limit': 10}
2025-03-14 21:36:29,854 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'teste' encontrou 1 resultados novos
2025-03-14 21:36:29,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:29,855 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.094s ago] {'termo_search': '%alcool%', 'limit': 10}
2025-03-14 21:36:30,070 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'alcool' encontrou 0 resultados novos
2025-03-14 21:36:30,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:36:30,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.311s ago] {'termo_search': '%soprar%', 'limit': 10}
2025-03-14 21:36:30,297 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'soprar' encontrou 0 resultados novos
2025-03-14 21:36:30,297 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:36:30,297 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:36:30,298 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:36:30,298 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:36:32,558 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '50020', skip=0, limit=10
2025-03-14 21:36:32,558 - MultasGO - INFO - [search_service.py:116] - Busca original: '50020', normalizada: '50020', código extraído: '50020'
2025-03-14 21:36:32,775 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:36:32,776 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:36:32,777 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7455s ago] {}
2025-03-14 21:36:33,221 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:36:33,222 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:36:33,222 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:36:33,223 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:36:33,223 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7455s ago] {'codigo_exato': '50020', 'codigo_inicio': '50020%', 'codigo_parcial': '%50020%', 'codigo_sem_hifen': '50020', 'limit': 20}
2025-03-14 21:36:33,462 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:36:33,462 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:36:33,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:36:33,463 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7455s ago] {'texto_search': '%50020%', 'texto_search_exato': '50020', 'texto_search_inicio': '50020%', 'limit': 20}
2025-03-14 21:36:33,684 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:36:33,685 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:36:33,685 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7455s ago] {}
2025-03-14 21:36:33,905 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:36:33,905 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:36:33,906 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:36:33,906 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:36:33,908 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:28,048 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:37:28,048 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:37:28,274 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:28,274 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:28,275 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7511s ago] {}
2025-03-14 21:37:28,711 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:28,712 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:28,712 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:28,713 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:37:28,713 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7511s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:37:28,930 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:37:28,931 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:28,931 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7511s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:37:29,150 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:37:29,151 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:37:29,152 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7511s ago] {}
2025-03-14 21:37:29,384 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:37:29,384 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:37:29,384 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:37:29,385 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:37:29,387 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:31,403 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:37:31,403 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:37:31,607 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:31,608 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:31,608 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7514s ago] {}
2025-03-14 21:37:32,011 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:32,012 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:32,012 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:32,013 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:37:32,013 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7514s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:37:32,224 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:37:32,225 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:32,226 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7514s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:37:32,442 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:37:32,443 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:37:32,443 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7514s ago] {}
2025-03-14 21:37:32,644 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:37:32,645 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:37:32,645 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:37:32,646 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:37:32,647 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:34,686 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '757', skip=0, limit=10
2025-03-14 21:37:34,687 - MultasGO - INFO - [search_service.py:116] - Busca original: '757', normalizada: '757', código extraído: '757'
2025-03-14 21:37:34,882 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:34,883 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:34,883 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7517s ago] {}
2025-03-14 21:37:35,282 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:35,282 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:35,283 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:35,283 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:37:35,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7517s ago] {'codigo_exato': '757', 'codigo_inicio': '757%', 'codigo_parcial': '%757%', 'codigo_sem_hifen': '757', 'limit': 20}
2025-03-14 21:37:35,501 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 3 resultados
2025-03-14 21:37:35,502 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:35,502 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7517s ago] {'texto_search': '%757%', 'texto_search_exato': '757', 'texto_search_inicio': '757%', 'limit': 20}
2025-03-14 21:37:35,701 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:37:35,702 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:37:35,703 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:37:35,703 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:37:35,704 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:37,957 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:37:37,958 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:37:38,166 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:38,167 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:38,167 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7521s ago] {}
2025-03-14 21:37:38,572 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:38,572 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:38,573 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:38,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:38,574 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7520s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:37:38,778 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:37:38,779 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:37:38,779 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:37:38,780 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:37:38,780 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:41,029 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'recusa', skip=0, limit=10
2025-03-14 21:37:41,029 - MultasGO - INFO - [search_service.py:116] - Busca original: 'recusa', normalizada: 'recusa', código extraído: ''
2025-03-14 21:37:41,235 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:41,236 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:41,236 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7524s ago] {}
2025-03-14 21:37:41,644 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:41,645 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:41,645 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:41,646 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:41,646 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7523s ago] {'texto_search': '%recusa%', 'texto_search_exato': 'recusa', 'texto_search_inicio': 'recusa%', 'limit': 20}
2025-03-14 21:37:41,850 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 3 resultados novos
2025-03-14 21:37:41,851 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:41,852 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 73.09s ago] {'termo_search': '%recusa%', 'limit': 10}
2025-03-14 21:37:42,051 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusa' encontrou 3 resultados novos
2025-03-14 21:37:42,052 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:42,052 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 73.29s ago] {'termo_search': '%recusar%', 'limit': 10}
2025-03-14 21:37:42,260 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusar' encontrou 2 resultados novos
2025-03-14 21:37:42,260 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:42,261 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 73.5s ago] {'termo_search': '%etilometro%', 'limit': 10}
2025-03-14 21:37:42,478 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'etilometro' encontrou 0 resultados novos
2025-03-14 21:37:42,478 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:42,479 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 73.72s ago] {'termo_search': '%bafometro%', 'limit': 10}
2025-03-14 21:37:42,682 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'bafometro' encontrou 0 resultados novos
2025-03-14 21:37:42,683 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:42,684 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 73.92s ago] {'termo_search': '%teste%', 'limit': 10}
2025-03-14 21:37:42,890 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'teste' encontrou 1 resultados novos
2025-03-14 21:37:42,891 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:42,892 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 74.13s ago] {'termo_search': '%alcool%', 'limit': 10}
2025-03-14 21:37:43,090 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'alcool' encontrou 0 resultados novos
2025-03-14 21:37:43,091 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:37:43,092 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 74.33s ago] {'termo_search': '%soprar%', 'limit': 10}
2025-03-14 21:37:43,297 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'soprar' encontrou 0 resultados novos
2025-03-14 21:37:43,298 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:37:43,299 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:37:43,299 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:37:43,300 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:37:45,561 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '50020', skip=0, limit=10
2025-03-14 21:37:45,562 - MultasGO - INFO - [search_service.py:116] - Busca original: '50020', normalizada: '50020', código extraído: '50020'
2025-03-14 21:37:45,765 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:37:45,766 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:37:45,766 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7528s ago] {}
2025-03-14 21:37:46,175 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:37:46,175 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:37:46,176 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:37:46,176 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:37:46,177 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7528s ago] {'codigo_exato': '50020', 'codigo_inicio': '50020%', 'codigo_parcial': '%50020%', 'codigo_sem_hifen': '50020', 'limit': 20}
2025-03-14 21:37:46,387 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:37:46,387 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:37:46,388 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:37:46,388 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7528s ago] {'texto_search': '%50020%', 'texto_search_exato': '50020', 'texto_search_inicio': '50020%', 'limit': 20}
2025-03-14 21:37:46,591 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:37:46,592 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:37:46,592 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7528s ago] {}
2025-03-14 21:37:46,794 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:37:46,795 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    for row in result_populares:
                                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    for row in result_populares:
                                 
ValueError: too many values to unpack (expected 2)

2025-03-14 21:37:46,795 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:37:46,795 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:37:46,798 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:23,462 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 21:40:23,462 - MultasGO - INFO - [search_service.py:116] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 21:40:23,663 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:23,664 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:23,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7686s ago] {}
2025-03-14 21:40:24,060 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:24,062 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:24,062 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:24,062 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:40:24,063 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7686s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'limit': 20}
2025-03-14 21:40:24,273 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:40:24,273 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:24,274 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7686s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 21:40:24,489 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:40:24,490 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:40:24,491 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7686s ago] {}
2025-03-14 21:40:24,693 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:40:24,694 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                           ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:40:24,695 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:40:24,695 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:40:24,697 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:26,731 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:40:26,731 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:40:26,931 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:26,931 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:26,932 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7689s ago] {}
2025-03-14 21:40:27,346 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:27,346 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:27,347 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:27,347 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:40:27,348 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7689s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:40:27,565 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:40:27,565 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:27,566 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7689s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:40:27,767 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:40:27,767 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:40:27,768 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7689s ago] {}
2025-03-14 21:40:27,968 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:40:27,969 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                           ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:40:27,969 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:40:27,970 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:40:27,971 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:30,026 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '757', skip=0, limit=10
2025-03-14 21:40:30,026 - MultasGO - INFO - [search_service.py:116] - Busca original: '757', normalizada: '757', código extraído: '757'
2025-03-14 21:40:30,228 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:30,229 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:30,229 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7693s ago] {}
2025-03-14 21:40:30,638 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:30,638 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:30,639 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:30,640 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:40:30,640 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7693s ago] {'codigo_exato': '757', 'codigo_inicio': '757%', 'codigo_parcial': '%757%', 'codigo_sem_hifen': '757', 'limit': 20}
2025-03-14 21:40:30,840 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 3 resultados
2025-03-14 21:40:30,841 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:30,842 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7693s ago] {'texto_search': '%757%', 'texto_search_exato': '757', 'texto_search_inicio': '757%', 'limit': 20}
2025-03-14 21:40:31,054 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:40:31,055 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:40:31,055 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:40:31,056 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:40:31,056 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:33,311 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:40:33,311 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:40:33,543 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:33,546 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:33,548 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7696s ago] {}
2025-03-14 21:40:33,985 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:33,985 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:33,986 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:33,986 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:33,986 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7696s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:40:34,200 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:40:34,201 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:40:34,201 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:40:34,202 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:40:34,202 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:36,474 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'recusa', skip=0, limit=10
2025-03-14 21:40:36,476 - MultasGO - INFO - [search_service.py:116] - Busca original: 'recusa', normalizada: 'recusa', código extraído: ''
2025-03-14 21:40:36,676 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:36,677 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:36,677 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7699s ago] {}
2025-03-14 21:40:37,075 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:37,075 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:37,076 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:37,076 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:37,077 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7699s ago] {'texto_search': '%recusa%', 'texto_search_exato': 'recusa', 'texto_search_inicio': 'recusa%', 'limit': 20}
2025-03-14 21:40:37,283 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 3 resultados novos
2025-03-14 21:40:37,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:37,284 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 248.5s ago] {'termo_search': '%recusa%', 'limit': 10}
2025-03-14 21:40:37,492 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusa' encontrou 3 resultados novos
2025-03-14 21:40:37,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:37,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 248.7s ago] {'termo_search': '%recusar%', 'limit': 10}
2025-03-14 21:40:37,689 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'recusar' encontrou 2 resultados novos
2025-03-14 21:40:37,689 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:37,690 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 248.9s ago] {'termo_search': '%etilometro%', 'limit': 10}
2025-03-14 21:40:37,887 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'etilometro' encontrou 0 resultados novos
2025-03-14 21:40:37,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:37,888 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 249.1s ago] {'termo_search': '%bafometro%', 'limit': 10}
2025-03-14 21:40:38,096 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'bafometro' encontrou 0 resultados novos
2025-03-14 21:40:38,096 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:38,097 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 249.3s ago] {'termo_search': '%teste%', 'limit': 10}
2025-03-14 21:40:38,304 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'teste' encontrou 1 resultados novos
2025-03-14 21:40:38,306 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:38,306 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 249.5s ago] {'termo_search': '%alcool%', 'limit': 10}
2025-03-14 21:40:38,516 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'alcool' encontrou 0 resultados novos
2025-03-14 21:40:38,517 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 21:40:38,517 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 249.8s ago] {'termo_search': '%soprar%', 'limit': 10}
2025-03-14 21:40:38,715 - MultasGO - INFO - [search_service.py:293] - Busca por termo especial 'soprar' encontrou 0 resultados novos
2025-03-14 21:40:38,717 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:40:38,718 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:40:38,719 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:40:38,719 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:40:40,954 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '50020', skip=0, limit=10
2025-03-14 21:40:40,954 - MultasGO - INFO - [search_service.py:116] - Busca original: '50020', normalizada: '50020', código extraído: '50020'
2025-03-14 21:40:41,154 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:40:41,155 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:40:41,155 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7704s ago] {}
2025-03-14 21:40:41,571 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:40:41,572 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:40:41,572 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:40:41,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:40:41,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7704s ago] {'codigo_exato': '50020', 'codigo_inicio': '50020%', 'codigo_parcial': '%50020%', 'codigo_sem_hifen': '50020', 'limit': 20}
2025-03-14 21:40:41,776 - MultasGO - WARNING - [search_service.py:476] - Erro ao converter pontos: Não há
2025-03-14 21:40:41,777 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:40:41,777 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:40:41,778 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7704s ago] {'texto_search': '%50020%', 'texto_search_exato': '50020', 'texto_search_inicio': '50020%', 'limit': 20}
2025-03-14 21:40:41,981 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:40:41,982 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:40:41,982 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7703s ago] {}
2025-03-14 21:40:42,188 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:40:42,188 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                           ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:40:42,189 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:40:42,189 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:40:42,191 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:41:46,481 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:41:46,481 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:41:46,677 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:41:46,678 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:41:46,678 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7769s ago] {}
2025-03-14 21:41:47,076 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:41:47,077 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:41:47,077 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:41:47,077 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:41:47,078 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7769s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:41:47,285 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:41:47,286 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:41:47,287 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7769s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:41:47,488 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:41:47,489 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:41:47,489 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7769s ago] {}
2025-03-14 21:41:47,687 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:41:47,687 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                           ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:41:47,688 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:41:47,688 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:41:47,690 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:41:54,071 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:41:54,071 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:41:54,279 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:41:54,279 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:41:54,280 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7777s ago] {}
2025-03-14 21:41:54,693 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:41:54,694 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:41:54,694 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:41:54,694 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:41:54,695 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7776s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:41:54,903 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:41:54,904 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:41:54,904 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:41:54,905 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:41:54,905 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:42:51,227 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:42:51,228 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:42:51,443 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:42:51,444 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:42:51,444 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7834s ago] {}
2025-03-14 21:42:51,852 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:42:51,853 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:42:51,853 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:42:51,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:42:51,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7834s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:42:52,055 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:42:52,055 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:42:52,056 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7834s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:42:52,259 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:42:52,260 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:42:52,260 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7834s ago] {}
2025-03-14 21:42:52,475 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:42:52,476 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    pontuacoes_relevancia[_get_attr_or_key(resultado, 'codigo')] = 50 - (idx_termo * 5) - idx_resultado
                           ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 21:42:52,476 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:42:52,477 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:42:52,478 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:43:00,940 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:43:00,940 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:43:01,153 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:43:01,154 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:43:01,154 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7844s ago] {}
2025-03-14 21:43:01,580 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:43:01,580 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:43:01,580 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:43:01,581 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:43:01,581 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7843s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:43:01,795 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:43:01,796 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:43:01,797 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:43:01,797 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:43:01,798 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:44:01,773 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:44:01,774 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:44:01,971 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:44:01,971 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:44:01,972 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7904s ago] {}
2025-03-14 21:44:02,367 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:44:02,368 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:44:02,368 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:44:02,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:44:02,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7904s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:44:02,565 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:44:02,566 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:44:02,567 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7904s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:44:02,764 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:44:02,764 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:44:02,765 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7904s ago] {}
2025-03-14 21:44:02,962 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:44:02,963 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:44:02,964 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:44:02,964 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:44:02,966 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:44:08,865 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:44:08,865 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:44:09,074 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:44:09,075 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:44:09,076 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7912s ago] {}
2025-03-14 21:44:09,494 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:44:09,495 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:44:09,495 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:44:09,496 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:44:09,496 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 7911s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:44:09,705 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:44:09,706 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:44:09,706 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    limit: int = Query(10, description="Número máximo de registros para retornar"),
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:44:09,707 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:44:09,707 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:45:45,284 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:45:45,284 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:45:45,500 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:45:45,501 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:45:45,502 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8008s ago] {}
2025-03-14 21:45:45,898 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:45:45,898 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:45:45,899 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:45:45,899 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:45:45,900 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8008s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:45:46,103 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:45:46,104 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:45:46,104 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:45:46,106 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:45:46,106 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:47:04,290 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:47:04,290 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:47:04,492 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:47:04,492 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:47:04,493 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8087s ago] {}
2025-03-14 21:47:04,924 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:47:04,924 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:47:04,925 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:47:04,925 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:47:04,926 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8087s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:47:05,128 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:47:05,129 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:47:05,129 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:47:05,130 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:47:05,130 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:50:43,173 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:50:43,174 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:50:43,210 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:50:48,655 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:50:48,656 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:50:50,257 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:50:50,258 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:50:50,258 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8313s ago] {}
2025-03-14 21:50:50,660 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:50:50,661 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:50:50,661 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:50:50,662 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:50:50,663 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8312s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:50:50,867 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:50:50,868 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:50:50,868 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:50:50,869 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:50:50,869 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:50:53,114 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:50:53,114 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:50:53,322 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:50:53,322 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:50:53,323 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8316s ago] {}
2025-03-14 21:50:53,739 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:50:53,740 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:50:53,740 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:50:53,741 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:50:53,742 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8316s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:50:53,942 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:50:53,944 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:50:53,944 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8316s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:50:54,173 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:50:54,173 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:50:54,174 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8316s ago] {}
2025-03-14 21:50:54,444 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:50:54,445 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:50:54,446 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:50:54,446 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:50:54,448 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:50:56,520 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:50:56,521 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:50:56,723 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:50:56,724 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:50:56,724 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8319s ago] {}
2025-03-14 21:50:57,146 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:50:57,147 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:50:57,147 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:50:57,148 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:50:57,148 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8319s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:50:57,368 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:50:57,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:50:57,369 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8319s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:50:57,631 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:50:57,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:50:57,633 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8319s ago] {}
2025-03-14 21:50:57,840 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:50:57,840 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:50:57,841 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:50:57,841 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:50:57,843 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:50:59,907 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 21:50:59,907 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 21:51:00,111 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:51:00,111 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:51:00,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8323s ago] {}
2025-03-14 21:51:00,524 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:51:00,525 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:51:00,525 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:51:00,525 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:51:00,526 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8322s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 21:51:00,728 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:51:00,729 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:51:00,729 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:51:00,730 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:51:00,730 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:52:18,096 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:52:18,096 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:52:18,142 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:52:23,242 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:52:23,243 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:52:23,454 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:52:23,455 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:52:23,455 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8406s ago] {}
2025-03-14 21:52:23,856 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:52:23,857 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:52:23,857 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:52:23,858 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:52:23,858 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8406s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:52:24,064 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:52:24,065 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:52:24,066 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:52:24,067 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:52:24,067 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:52:26,339 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:52:26,339 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:52:26,549 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:52:26,550 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:52:26,550 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8409s ago] {}
2025-03-14 21:52:26,952 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:52:26,952 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:52:26,954 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:52:26,954 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:52:26,954 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8409s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:52:27,164 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:52:27,164 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:52:27,165 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8409s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:52:27,384 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:52:27,384 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:52:27,385 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8409s ago] {}
2025-03-14 21:52:27,588 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:52:27,589 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:52:27,589 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:52:27,589 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:52:27,591 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:52:29,665 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:52:29,666 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:52:29,873 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:52:29,874 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:52:29,874 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8412s ago] {}
2025-03-14 21:52:30,283 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:52:30,284 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:52:30,284 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:52:30,285 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:52:30,285 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8412s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:52:30,514 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:52:30,515 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:52:30,515 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8412s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:52:30,719 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:52:30,719 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:52:30,721 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8412s ago] {}
2025-03-14 21:52:30,930 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:52:30,931 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:52:30,931 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:52:30,931 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:52:30,934 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:52:32,985 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 21:52:32,985 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 21:52:33,188 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:52:33,189 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:52:33,189 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8416s ago] {}
2025-03-14 21:52:33,614 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:52:33,615 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:52:33,615 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:52:33,616 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:52:33,616 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8415s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 21:52:33,821 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:52:33,822 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:52:33,822 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    logger.error(f"Stack trace: {stack_trace}")
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:52:33,822 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:52:33,823 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:58:24,305 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 21:58:24,305 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 21:58:24,337 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 21:58:24,413 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 21:58:24,413 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 21:58:24,413 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 21:58:24,414 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 21:58:24,414 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 21:58:24,414 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 21:58:26,582 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 21:58:26,582 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:58:26,977 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 21:58:26,977 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:58:27,375 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 21:58:27,375 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 21:58:27,775 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:58:27,776 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 21:58:27,776 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00048s] {}
2025-03-14 21:58:28,172 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 21:58:29,842 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 21:58:29,843 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 21:58:30,045 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:58:30,046 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:58:30,046 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8773s ago] {}
2025-03-14 21:58:30,470 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:58:30,471 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:58:30,471 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:58:30,472 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:58:30,472 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8772s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 21:58:30,680 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:58:30,681 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:58:30,681 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    except Exception as e:
                       ^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:58:30,682 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:58:30,682 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:58:32,954 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 21:58:32,954 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 21:58:33,156 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:58:33,156 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:58:33,156 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8776s ago] {}
2025-03-14 21:58:33,573 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:58:33,574 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:58:33,575 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:58:33,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:58:33,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8776s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 21:58:33,777 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:58:33,778 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:58:33,778 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8776s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 21:58:33,981 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:58:33,982 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:58:33,982 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8775s ago] {}
2025-03-14 21:58:34,185 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:58:34,186 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:58:34,188 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:58:34,188 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:58:34,189 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:58:36,272 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 21:58:36,272 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 21:58:36,482 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:58:36,483 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:58:36,483 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8779s ago] {}
2025-03-14 21:58:36,885 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:58:36,885 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:58:36,885 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:58:36,886 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 21:58:36,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8779s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 21:58:37,090 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 21:58:37,091 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:58:37,092 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8779s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 21:58:37,295 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 21:58:37,296 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 21:58:37,296 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8779s ago] {}
2025-03-14 21:58:37,498 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 21:58:37,499 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    result_especial = db.execute(
                        ^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    result_especial = db.execute(
                                  
ValueError: too many values to unpack (expected 2)

2025-03-14 21:58:37,499 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 21:58:37,499 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 21:58:37,501 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 21:58:39,563 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 21:58:39,564 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 21:58:39,810 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 21:58:39,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 21:58:39,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8782s ago] {}
2025-03-14 21:58:40,214 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 21:58:40,215 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 21:58:40,215 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 21:58:40,216 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 21:58:40,216 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8782s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 21:58:40,429 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 21:58:40,430 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 21:58:40,431 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    except Exception as e:
                       ^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 21:58:40,431 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 21:58:40,432 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:00:54,213 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 22:00:54,213 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 22:00:54,247 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 22:00:54,307 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 22:00:54,307 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 22:00:54,307 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 22:00:54,308 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 22:00:54,308 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 22:00:54,308 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 22:00:56,501 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 22:00:56,501 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 22:00:56,893 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 22:00:56,893 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 22:00:57,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 22:00:57,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 22:00:57,693 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:00:57,695 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 22:00:57,695 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00075s] {}
2025-03-14 22:00:58,088 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 22:00:59,803 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:00:59,804 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:01:00,004 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:01:00,005 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:01:00,005 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8922s ago] {}
2025-03-14 22:01:00,473 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:01:00,473 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:01:00,474 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:01:00,474 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:01:00,474 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8922s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:01:00,695 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:01:00,696 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:01:00,696 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:01:00,697 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:01:00,697 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:01:02,976 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:01:02,976 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:01:03,181 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:01:03,182 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:01:03,182 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8926s ago] {}
2025-03-14 22:01:03,587 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:01:03,588 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:01:03,588 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:01:03,589 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:01:03,590 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8926s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:01:03,795 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:01:03,795 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:01:03,796 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8926s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:01:03,997 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:01:03,998 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:01:03,998 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8926s ago] {}
2025-03-14 22:01:04,204 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:01:04,205 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    LIMIT :limit
                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    LIMIT :limit
                 
ValueError: too many values to unpack (expected 2)

2025-03-14 22:01:04,206 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:01:04,206 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:01:04,208 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:01:06,263 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:01:06,263 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:01:06,472 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:01:06,473 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:01:06,473 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8929s ago] {}
2025-03-14 22:01:06,873 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:01:06,874 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:01:06,874 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:01:06,874 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:01:06,875 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8929s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:01:07,082 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:01:07,082 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:01:07,083 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8929s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:01:07,294 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:01:07,294 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:01:07,296 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8929s ago] {}
2025-03-14 22:01:07,496 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:01:07,497 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    LIMIT :limit
                 
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    LIMIT :limit
                 
ValueError: too many values to unpack (expected 2)

2025-03-14 22:01:07,498 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:01:07,498 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:01:07,499 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:01:09,580 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:01:09,580 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:01:09,778 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:01:09,779 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:01:09,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8932s ago] {}
2025-03-14 22:01:10,182 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:01:10,182 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:01:10,182 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:01:10,182 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:01:10,183 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 8932s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:01:10,402 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:01:10,403 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:01:10,403 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:01:10,404 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:01:10,404 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:03:00,784 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 22:03:00,784 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 22:03:00,817 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 22:03:06,408 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:03:06,409 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:03:06,608 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:03:06,608 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:03:06,609 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9049s ago] {}
2025-03-14 22:03:07,012 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:03:07,012 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:03:07,013 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:03:07,013 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:03:07,014 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9049s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:03:07,222 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:03:07,223 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:03:07,223 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:03:07,224 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:03:07,224 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:03:09,503 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:03:09,503 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:03:09,705 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:03:09,706 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:03:09,707 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9052s ago] {}
2025-03-14 22:03:10,104 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:03:10,104 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:03:10,106 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:03:10,106 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:03:10,106 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9052s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:03:10,310 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:03:10,310 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:03:10,311 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9052s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:03:10,515 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:03:10,516 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:03:10,516 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9052s ago] {}
2025-03-14 22:03:10,758 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:03:10,759 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Verificar similaridade parcial (útil para erros de digitação)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Verificar similaridade parcial (útil para erros de digitação)
                                       ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:03:10,759 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:03:10,759 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:03:10,761 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:03:12,841 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:03:12,842 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:03:13,047 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:03:13,047 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:03:13,048 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9056s ago] {}
2025-03-14 22:03:13,451 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:03:13,451 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:03:13,452 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:03:13,452 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:03:13,453 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9056s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:03:13,657 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:03:13,658 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:03:13,658 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9055s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:03:13,860 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:03:13,860 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:03:13,861 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9055s ago] {}
2025-03-14 22:03:14,063 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:03:14,064 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Verificar similaridade parcial (útil para erros de digitação)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Verificar similaridade parcial (útil para erros de digitação)
                                       ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:03:14,064 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:03:14,064 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:03:14,066 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:03:16,156 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:03:16,156 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:03:16,361 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:03:16,362 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:03:16,362 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9059s ago] {}
2025-03-14 22:03:16,770 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:03:16,770 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:03:16,770 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:03:16,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:03:16,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9059s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:03:16,977 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:03:16,978 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:03:16,978 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:03:16,979 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:03:16,979 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:05:56,333 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:05:56,333 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:05:56,558 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:05:56,559 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:05:56,559 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9219s ago] {}
2025-03-14 22:05:56,974 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:05:56,975 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:05:56,975 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:05:56,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:05:56,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9219s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:05:57,190 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:05:57,192 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:05:57,192 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    A pesquisa suporta busca exata por código e busca fuzzy por descrição,
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:05:57,193 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:05:57,193 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:05:59,474 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:05:59,474 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:05:59,722 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:05:59,722 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:05:59,723 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9222s ago] {}
2025-03-14 22:06:00,147 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:06:00,147 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:06:00,148 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:06:00,148 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:06:00,149 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9222s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:06:00,384 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:06:00,385 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:06:00,385 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9222s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:06:00,604 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:06:00,605 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:06:00,605 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9222s ago] {}
2025-03-14 22:06:00,824 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:06:00,825 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Verificar similaridade parcial (útil para erros de digitação)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Verificar similaridade parcial (útil para erros de digitação)
                                       ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:06:00,825 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:06:00,825 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:06:00,827 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:06:02,895 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:06:02,895 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:06:03,211 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:06:03,211 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:06:03,212 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9226s ago] {}
2025-03-14 22:06:03,695 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:06:03,696 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:06:03,696 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:06:03,696 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:06:03,697 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9226s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:06:03,912 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:06:03,912 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:06:03,913 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9226s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:06:04,125 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:06:04,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:06:04,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9226s ago] {}
2025-03-14 22:06:04,374 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:06:04,375 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Verificar similaridade parcial (útil para erros de digitação)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Verificar similaridade parcial (útil para erros de digitação)
                                       ^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:06:04,375 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:06:04,375 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:06:04,377 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:06:06,408 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:06:06,408 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:06:06,635 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:06:06,635 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:06:06,636 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9229s ago] {}
2025-03-14 22:06:07,123 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:06:07,123 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:06:07,124 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:06:07,124 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:06:07,125 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9229s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:06:07,386 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:06:07,387 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:06:07,387 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    A pesquisa suporta busca exata por código e busca fuzzy por descrição,
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:06:07,388 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:06:07,388 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:08:36,177 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:08:36,178 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:08:36,386 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:08:36,387 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:08:36,388 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9379s ago] {}
2025-03-14 22:08:36,810 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:08:36,810 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:08:36,811 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:08:36,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:08:36,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9379s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:08:37,017 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:08:37,018 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:08:37,018 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    A pesquisa suporta busca exata por código e busca fuzzy por descrição,
                       ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:08:37,019 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:08:37,020 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:11:18,219 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:11:18,220 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:11:18,426 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:11:18,426 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:11:18,427 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9541s ago] {}
2025-03-14 22:11:18,831 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:11:18,831 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:11:18,831 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:11:18,832 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:11:18,833 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9541s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:11:19,038 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:11:19,039 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:11:19,039 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:11:19,040 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:11:19,040 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:13:42,229 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:13:42,230 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:13:42,434 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:13:42,434 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:13:42,435 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9685s ago] {}
2025-03-14 22:13:42,839 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:13:42,839 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:13:42,840 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:13:42,840 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:13:42,841 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9685s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:13:43,047 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:13:43,048 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:13:43,048 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:13:43,049 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:13:43,049 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:13:45,947 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:13:45,947 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:13:46,148 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:13:46,149 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:13:46,150 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9689s ago] {}
2025-03-14 22:13:46,566 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:13:46,566 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:13:46,567 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:13:46,567 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:13:46,568 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9689s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:13:46,770 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:13:46,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:13:46,772 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9689s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:13:46,975 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:13:46,975 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:13:46,976 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9688s ago] {}
2025-03-14 22:13:47,178 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:13:47,179 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
ValueError: too many values to unpack (expected 2)

2025-03-14 22:13:47,180 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:13:47,180 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:13:47,182 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:13:49,705 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:13:49,706 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:13:49,908 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:13:49,908 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:13:49,909 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9692s ago] {}
2025-03-14 22:13:50,317 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:13:50,317 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:13:50,318 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:13:50,318 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:13:50,319 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9692s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:13:50,537 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:13:50,537 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:13:50,538 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9692s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:13:50,741 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:13:50,741 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:13:50,742 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9692s ago] {}
2025-03-14 22:13:50,960 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:13:50,960 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
ValueError: too many values to unpack (expected 2)

2025-03-14 22:13:50,961 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:13:50,961 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:13:50,963 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:13:53,524 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:13:53,525 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:13:53,725 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:13:53,726 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:13:53,726 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9696s ago] {}
2025-03-14 22:13:54,124 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:13:54,125 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:13:54,125 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:13:54,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:13:54,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9696s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:13:54,335 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:13:54,336 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:13:54,336 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:13:54,337 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:13:54,337 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:17:49,489 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:17:49,490 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:17:49,707 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:17:49,707 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:17:49,708 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9932s ago] {}
2025-03-14 22:17:50,141 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:17:50,142 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:17:50,142 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:17:50,142 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:17:50,143 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9932s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:17:50,374 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:17:50,375 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:17:50,375 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:17:50,376 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:17:50,376 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:17:53,143 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:17:53,143 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:17:53,375 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:17:53,376 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:17:53,376 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9936s ago] {}
2025-03-14 22:17:53,810 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:17:53,811 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:17:53,811 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:17:53,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:17:53,813 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9936s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:17:54,036 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:17:54,036 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:17:54,036 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9936s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:17:54,266 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:17:54,267 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:17:54,267 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9936s ago] {}
2025-03-14 22:17:54,491 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:17:54,492 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Pontuação de relevância para palavras (menor que texto completo)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Pontuação de relevância para palavras (menor que texto completo)
                                ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:17:54,492 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:17:54,493 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:17:54,494 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:17:57,001 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:17:57,001 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:17:57,220 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:17:57,220 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:17:57,221 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9940s ago] {}
2025-03-14 22:17:57,663 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:17:57,664 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:17:57,664 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:17:57,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:17:57,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9940s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:17:57,887 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:17:57,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:17:57,888 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9940s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:17:58,107 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:17:58,108 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:17:58,108 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9940s ago] {}
2025-03-14 22:17:58,334 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:17:58,335 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    # Pontuação de relevância para palavras (menor que texto completo)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    # Pontuação de relevância para palavras (menor que texto completo)
                                ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:17:58,335 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:17:58,336 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:17:58,337 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:18:00,874 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:18:00,874 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:18:01,090 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:18:01,090 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:18:01,091 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9944s ago] {}
2025-03-14 22:18:01,550 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:18:01,550 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:18:01,551 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:18:01,552 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:18:01,552 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9943s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:18:01,770 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:18:01,770 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:18:01,770 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:18:01,771 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:18:01,771 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:20:52,454 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:20:52,455 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:20:52,674 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:20:52,675 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:20:52,675 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {}
2025-03-14 22:20:53,114 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:20:53,115 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:20:53,115 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:20:53,115 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:20:53,116 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.011e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:20:53,338 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:20:53,339 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:20:53,339 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:20:53,340 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:20:53,340 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:20:56,160 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:20:56,161 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:20:56,392 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:20:56,393 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:20:56,394 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {}
2025-03-14 22:20:56,792 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:20:56,792 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:20:56,792 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:20:56,792 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:20:56,794 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:20:56,994 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:20:56,994 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:20:56,995 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:20:57,199 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:20:57,200 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:20:57,200 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {}
2025-03-14 22:20:57,413 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:20:57,414 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:20:57,415 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:20:57,415 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:20:57,417 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:21:00,002 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:21:00,003 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:21:00,204 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:21:00,204 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:21:00,205 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {}
2025-03-14 22:21:00,604 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:21:00,605 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:21:00,605 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:21:00,606 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:21:00,606 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:21:00,810 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:21:00,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:21:00,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:21:01,013 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:21:01,014 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:21:01,014 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.012e+04s ago] {}
2025-03-14 22:21:01,220 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:21:01,221 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:21:01,222 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:21:01,222 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:21:01,223 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:21:03,768 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:21:03,768 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:21:03,968 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:21:03,969 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:21:03,969 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.013e+04s ago] {}
2025-03-14 22:21:04,372 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:21:04,372 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:21:04,372 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:21:04,373 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:21:04,373 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.013e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:21:04,579 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:21:04,580 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:21:04,580 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:21:04,581 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:21:04,581 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:27:19,733 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:27:19,733 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:27:19,949 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:27:19,949 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:27:19,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.05e+04s ago] {}
2025-03-14 22:27:20,392 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:27:20,392 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:27:20,393 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:27:20,393 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:27:20,394 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.05e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:27:20,616 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:27:20,617 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:27:20,618 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:27:20,618 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:27:20,619 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:27:23,887 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:27:23,887 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:27:25,592 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:27:25,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:27:25,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {}
2025-03-14 22:27:26,028 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:27:26,029 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:27:26,029 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:27:26,029 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:27:26,030 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:27:26,253 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:27:26,254 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:27:26,254 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:27:26,489 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:27:26,490 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:27:26,491 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {}
2025-03-14 22:27:26,710 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:27:26,711 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:27:26,711 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:27:26,711 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:27:26,713 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:27:29,730 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:27:29,731 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:27:29,950 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:27:29,951 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:27:29,951 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {}
2025-03-14 22:27:30,390 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:27:30,391 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:27:30,391 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:27:30,392 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:27:30,392 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:27:30,613 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:27:30,614 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:27:30,614 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:27:30,832 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:27:30,833 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:27:30,833 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.051e+04s ago] {}
2025-03-14 22:27:31,057 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:27:31,058 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:27:31,058 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:27:31,058 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:27:31,060 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:28:57,417 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:28:57,418 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:28:57,636 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:28:57,637 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:28:57,637 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {}
2025-03-14 22:28:58,072 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:28:58,072 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:28:58,072 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:28:58,073 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:28:58,073 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:28:58,295 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:28:58,296 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:28:58,296 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:28:58,297 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:28:58,297 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:29:01,613 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:29:01,613 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:29:01,831 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:29:01,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:29:01,832 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {}
2025-03-14 22:29:02,268 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:29:02,269 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:29:02,269 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:29:02,270 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:29:02,270 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:29:02,494 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:29:02,494 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:29:02,494 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:29:02,712 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:29:02,712 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:29:02,713 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.06e+04s ago] {}
2025-03-14 22:29:02,930 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:29:02,931 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:29:02,931 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:29:02,931 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:29:02,933 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:29:05,998 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:29:05,998 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:29:06,226 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:29:06,226 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:29:06,227 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {}
2025-03-14 22:29:06,672 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:29:06,673 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:29:06,673 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:29:06,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:29:06,674 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:29:06,896 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:29:06,897 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:29:06,897 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:29:07,116 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:29:07,117 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:29:07,117 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {}
2025-03-14 22:29:07,337 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:29:07,338 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    if len(palavra) >= 3:  # Ignorar palavras muito curtas
                                               ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:29:07,338 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:29:07,338 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:29:07,340 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:29:10,413 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:29:10,413 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:29:10,630 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:29:10,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:29:10,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {}
2025-03-14 22:29:11,073 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:29:11,073 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:29:11,074 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:29:11,074 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:29:11,075 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.061e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:29:11,308 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:29:11,309 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:29:11,309 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    )
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:29:11,310 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:29:11,310 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:32:42,432 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:32:42,433 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:32:42,651 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:32:42,651 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:32:42,652 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {}
2025-03-14 22:32:43,087 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:32:43,088 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:32:43,088 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:32:43,089 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:32:43,089 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.082e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:32:43,319 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:32:43,321 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:32:43,321 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:32:43,322 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:32:43,322 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:32:46,631 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:32:46,632 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:32:46,851 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:32:46,852 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:32:46,852 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {}
2025-03-14 22:32:47,287 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:32:47,288 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:32:47,288 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:32:47,289 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:32:47,289 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:32:47,521 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:32:47,522 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:32:47,523 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:32:47,743 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:32:47,743 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:32:47,744 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {}
2025-03-14 22:32:47,960 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:32:47,961 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:32:47,962 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:32:47,962 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:32:47,963 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:32:51,040 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:32:51,040 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:32:51,263 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:32:51,264 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:32:51,264 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {}
2025-03-14 22:32:51,701 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:32:51,701 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:32:51,702 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:32:51,702 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:32:51,703 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:32:51,926 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:32:51,927 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:32:51,927 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:32:52,147 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:32:52,148 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:32:52,149 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.083e+04s ago] {}
2025-03-14 22:32:52,375 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:32:52,375 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:32:52,376 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:32:52,376 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:32:52,377 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:32:55,445 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:32:55,445 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:32:55,672 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:32:55,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:32:55,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.084e+04s ago] {}
2025-03-14 22:32:56,126 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:32:56,127 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:32:56,127 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:32:56,128 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:32:56,128 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.084e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:32:56,363 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:32:56,364 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:32:56,365 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:32:56,365 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:32:56,366 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:34:41,141 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:34:41,142 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:34:41,351 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:34:41,351 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:34:41,352 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.094e+04s ago] {}
2025-03-14 22:34:41,752 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:34:41,753 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:34:41,753 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:34:41,754 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:34:41,754 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.094e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:34:41,961 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:34:41,962 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:34:41,962 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:34:41,963 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:34:41,963 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:34:45,233 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:34:45,234 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:34:45,441 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:34:45,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:34:45,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {}
2025-03-14 22:34:45,844 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:34:45,844 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:34:45,845 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:34:45,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:34:45,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:34:46,052 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:34:46,052 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:34:46,053 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:34:46,270 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:34:46,270 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:34:46,271 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {}
2025-03-14 22:34:46,478 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:34:46,479 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:34:46,480 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:34:46,480 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:34:46,482 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:34:49,548 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:34:49,548 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:34:49,749 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:34:49,749 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:34:49,750 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {}
2025-03-14 22:34:50,150 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:34:50,151 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:34:50,151 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:34:50,151 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:34:50,152 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:34:50,369 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:34:50,370 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:34:50,371 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:34:50,574 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:34:50,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:34:50,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.095e+04s ago] {}
2025-03-14 22:34:50,777 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:34:50,778 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:34:50,778 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:34:50,779 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:34:50,780 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:34:53,838 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:34:53,839 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:34:54,040 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:34:54,040 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:34:54,041 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.096e+04s ago] {}
2025-03-14 22:34:54,468 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:34:54,469 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:34:54,469 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:34:54,470 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:34:54,470 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.096e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:34:54,678 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:34:54,679 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:34:54,679 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:34:54,680 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:34:54,680 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:37:39,914 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:37:39,914 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:37:40,119 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:37:40,120 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:37:40,120 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.112e+04s ago] {}
2025-03-14 22:37:40,538 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:37:40,538 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:37:40,538 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:37:40,539 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:37:40,540 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.112e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:37:40,753 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:37:40,754 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:37:40,755 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:37:40,755 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:37:40,756 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:37:44,054 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:37:44,054 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:37:44,260 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:37:44,261 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:37:44,262 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {}
2025-03-14 22:37:44,679 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:37:44,680 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:37:44,681 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:37:44,681 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:37:44,682 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:37:44,886 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:37:44,886 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:37:44,888 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:37:45,092 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:37:45,092 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:37:45,093 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {}
2025-03-14 22:37:45,307 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:37:45,308 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:37:45,309 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:37:45,309 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:37:45,310 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:37:48,383 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:37:48,383 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:37:48,584 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:37:48,584 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:37:48,584 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {}
2025-03-14 22:37:48,994 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:37:48,995 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:37:48,995 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:37:48,996 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:37:48,996 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:37:49,208 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:37:49,208 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:37:49,209 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:37:49,412 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:37:49,412 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:37:49,413 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.113e+04s ago] {}
2025-03-14 22:37:49,614 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:37:49,615 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:37:49,616 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:37:49,616 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:37:49,618 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:37:52,679 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:37:52,679 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:37:52,883 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:37:52,884 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:37:52,884 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.114e+04s ago] {}
2025-03-14 22:37:53,299 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:37:53,299 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:37:53,300 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:37:53,300 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:37:53,301 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.114e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:37:53,507 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:37:53,507 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:37:53,508 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:37:53,508 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:37:53,509 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:41:10,096 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:41:10,097 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:41:10,306 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:41:10,307 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:41:10,307 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.133e+04s ago] {}
2025-03-14 22:41:10,721 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:41:10,722 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:41:10,722 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:41:10,722 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:41:10,723 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.133e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:41:10,931 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:41:10,931 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:41:10,932 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:41:10,932 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:41:10,933 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:41:14,191 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:41:14,191 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:41:14,434 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:41:14,434 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:41:14,435 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {}
2025-03-14 22:41:14,835 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:41:14,836 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:41:14,836 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:41:14,836 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:41:14,837 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:41:15,037 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:41:15,038 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:41:15,038 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:41:15,247 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:41:15,248 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:41:15,248 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {}
2025-03-14 22:41:15,458 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:41:15,460 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:41:15,460 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:41:15,460 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:41:15,462 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:41:18,541 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:41:18,542 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:41:18,742 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:41:18,743 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:41:18,743 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {}
2025-03-14 22:41:19,145 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:41:19,145 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:41:19,146 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:41:19,146 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:41:19,147 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:41:19,350 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:41:19,350 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:41:19,351 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:41:19,555 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:41:19,556 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:41:19,556 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.134e+04s ago] {}
2025-03-14 22:41:19,768 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:41:19,769 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:41:19,769 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:41:19,770 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:41:19,771 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:41:22,819 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:41:22,820 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:41:23,020 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:41:23,021 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:41:23,021 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.135e+04s ago] {}
2025-03-14 22:41:23,443 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:41:23,444 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:41:23,444 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:41:23,445 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:41:23,445 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.135e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:41:23,650 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:41:23,651 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:41:23,651 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:41:23,651 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:41:23,652 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:42:52,315 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:42:52,316 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:42:52,520 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:42:52,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:42:52,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {}
2025-03-14 22:42:52,964 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:42:52,965 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:42:52,966 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:42:52,966 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:42:52,967 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.143e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:42:53,173 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:42:53,174 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:42:53,174 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:42:53,175 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:42:53,175 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:42:56,435 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:42:56,435 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:42:56,639 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:42:56,639 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:42:56,640 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {}
2025-03-14 22:42:57,037 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:42:57,038 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:42:57,038 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:42:57,039 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:42:57,040 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:42:57,249 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:42:57,250 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:42:57,250 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:42:57,467 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:42:57,467 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:42:57,468 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {}
2025-03-14 22:42:57,670 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:42:57,671 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:42:57,672 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:42:57,672 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:42:57,673 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:43:00,749 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:43:00,750 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:43:00,948 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:43:00,949 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:43:00,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {}
2025-03-14 22:43:01,348 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:43:01,348 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:43:01,349 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:43:01,349 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:43:01,350 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:43:01,554 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:43:01,554 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:43:01,555 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:43:01,756 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:43:01,756 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:43:01,757 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.144e+04s ago] {}
2025-03-14 22:43:01,958 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:43:01,959 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:43:01,960 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:43:01,960 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:43:01,962 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:43:05,014 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:43:05,015 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:43:05,219 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:43:05,219 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:43:05,219 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.145e+04s ago] {}
2025-03-14 22:43:05,627 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:43:05,627 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:43:05,628 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:43:05,628 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:43:05,629 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.145e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:43:05,831 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:43:05,832 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:43:05,832 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:43:05,833 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:43:05,833 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:45:28,856 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:45:28,857 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:45:29,079 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:45:29,080 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:45:29,080 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.159e+04s ago] {}
2025-03-14 22:45:29,530 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:45:29,530 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:45:29,531 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:45:29,531 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:45:29,532 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.159e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:45:29,751 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:45:29,753 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:45:29,753 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:45:29,754 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:45:29,754 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:45:33,068 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:45:33,068 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:45:33,290 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:45:33,291 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:45:33,291 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {}
2025-03-14 22:45:33,733 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:45:33,733 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:45:33,734 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:45:33,734 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:45:33,735 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:45:33,957 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:45:33,958 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:45:33,959 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:45:34,179 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:45:34,180 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:45:34,181 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {}
2025-03-14 22:45:34,402 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:45:34,402 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:45:34,403 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:45:34,403 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:45:34,405 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:45:37,491 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:45:37,492 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:45:37,709 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:45:37,709 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:45:37,709 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {}
2025-03-14 22:45:38,143 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:45:38,143 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:45:38,144 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:45:38,144 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:45:38,145 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:45:38,372 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:45:38,372 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:45:38,373 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:45:38,591 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:45:38,591 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:45:38,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {}
2025-03-14 22:45:38,810 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:45:38,811 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:45:38,811 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:45:38,812 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:45:38,813 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:45:41,904 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:45:41,904 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:45:42,122 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:45:42,122 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:45:42,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {}
2025-03-14 22:45:42,563 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:45:42,563 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:45:42,564 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:45:42,564 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:45:42,565 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.16e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:45:42,787 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:45:42,788 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:45:42,788 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:45:42,789 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:45:42,789 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:46:55,788 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:46:55,788 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:46:55,989 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:46:55,991 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:46:55,991 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {}
2025-03-14 22:46:56,402 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:46:56,403 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:46:56,403 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:46:56,404 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:46:56,404 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:46:56,610 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:46:56,611 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:46:56,611 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:46:56,612 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:46:56,612 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:46:59,884 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:46:59,884 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:47:00,084 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:47:00,085 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:47:00,085 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {}
2025-03-14 22:47:00,522 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:47:00,523 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:47:00,523 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:47:00,524 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:47:00,524 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:47:00,755 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:47:00,756 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:47:00,756 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:47:00,964 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:47:00,965 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:47:00,965 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.168e+04s ago] {}
2025-03-14 22:47:01,168 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:47:01,170 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:47:01,171 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:47:01,171 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:47:01,173 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:47:04,240 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:47:04,240 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:47:04,441 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:47:04,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:47:04,442 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {}
2025-03-14 22:47:04,853 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:47:04,853 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:47:04,853 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:47:04,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:47:04,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:47:05,058 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:47:05,059 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:47:05,060 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:47:05,267 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:47:05,268 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:47:05,269 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {}
2025-03-14 22:47:05,471 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:47:05,472 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:47:05,472 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:47:05,472 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:47:05,474 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:47:08,544 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:47:08,545 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:47:08,749 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:47:08,750 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:47:08,750 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {}
2025-03-14 22:47:09,156 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:47:09,156 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:47:09,157 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:47:09,157 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:47:09,158 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.169e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:47:09,372 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:47:09,373 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:47:09,373 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    }
      
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:47:09,374 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:47:09,375 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:48:24,154 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:48:24,154 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:48:24,355 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:48:24,356 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:48:24,356 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {}
2025-03-14 22:48:24,783 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:48:24,783 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:48:24,785 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:48:24,785 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:48:24,786 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:48:24,990 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:48:24,991 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:48:24,991 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    valor_multa=valor_multa,
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:48:24,993 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:48:24,993 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:48:28,250 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:48:28,250 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:48:28,461 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:48:28,461 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:48:28,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {}
2025-03-14 22:48:28,883 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:48:28,883 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:48:28,884 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:48:28,884 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:48:28,885 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:48:29,087 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:48:29,088 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:48:29,088 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:48:29,302 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:48:29,303 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:48:29,303 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.177e+04s ago] {}
2025-03-14 22:48:29,506 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:48:29,507 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:48:29,507 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:48:29,507 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:48:29,509 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:48:32,581 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:48:32,581 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:48:32,786 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:48:32,786 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:48:32,787 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {}
2025-03-14 22:48:33,206 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:48:33,206 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:48:33,207 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:48:33,207 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:48:33,208 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:48:33,435 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:48:33,436 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:48:33,436 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:48:33,649 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:48:33,650 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:48:33,650 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {}
2025-03-14 22:48:33,850 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:48:33,851 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:48:33,852 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:48:33,852 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:48:33,854 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:48:36,924 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:48:36,925 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:48:37,134 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:48:37,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:48:37,135 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {}
2025-03-14 22:48:37,591 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:48:37,592 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:48:37,592 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:48:37,592 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:48:37,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.178e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:48:37,815 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:48:37,815 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:48:37,816 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    valor_multa=valor_multa,
           ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:48:37,816 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:48:37,816 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:50:19,095 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:50:19,096 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:50:19,309 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:50:19,310 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:50:19,310 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.188e+04s ago] {}
2025-03-14 22:50:19,709 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:50:19,709 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:50:19,710 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:50:19,710 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:50:19,711 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.188e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:50:19,917 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:50:19,919 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:50:19,919 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    result = db.execute(text(sql), {"limit": limit, "skip": skip})
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:50:19,920 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:50:19,920 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:50:23,192 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:50:23,193 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:50:23,412 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:50:23,412 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:50:23,413 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {}
2025-03-14 22:50:23,847 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:50:23,848 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:50:23,848 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:50:23,848 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:50:23,849 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:50:24,059 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:50:24,060 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:50:24,060 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:50:24,316 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:50:24,316 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:50:24,317 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {}
2025-03-14 22:50:24,571 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:50:24,572 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:50:24,573 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:50:24,573 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:50:24,575 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:50:27,649 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:50:27,649 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:50:27,921 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:50:27,921 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:50:27,922 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {}
2025-03-14 22:50:28,366 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:50:28,366 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:50:28,367 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:50:28,367 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:50:28,368 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:50:28,577 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:50:28,578 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:50:28,578 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:50:28,784 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:50:28,784 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:50:28,785 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {}
2025-03-14 22:50:29,003 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:50:29,004 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:50:29,004 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:50:29,004 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:50:29,006 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:50:32,055 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'velocidade', skip=0, limit=10
2025-03-14 22:50:32,055 - MultasGO - INFO - [search_service.py:116] - Busca original: 'velocidade', normalizada: 'velocidade', código extraído: ''
2025-03-14 22:50:32,269 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:50:32,270 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:50:32,270 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {}
2025-03-14 22:50:32,768 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:50:32,769 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:50:32,769 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:50:32,769 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:50:32,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.189e+04s ago] {'texto_search': '%velocidade%', 'texto_search_exato': 'velocidade', 'texto_search_inicio': 'velocidade%', 'limit': 20}
2025-03-14 22:50:32,982 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:50:32,983 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:50:32,983 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    result = db.execute(text(sql), {"limit": limit, "skip": skip})
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:50:32,984 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:50:32,984 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:56:01,315 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: 'estacionar', skip=0, limit=10
2025-03-14 22:56:01,315 - MultasGO - INFO - [search_service.py:116] - Busca original: 'estacionar', normalizada: 'estacionar', código extraído: ''
2025-03-14 22:56:01,520 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:56:01,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:56:01,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.222e+04s ago] {}
2025-03-14 22:56:01,923 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:56:01,923 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:56:01,924 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:56:01,924 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:56:01,925 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.222e+04s ago] {'texto_search': '%estacionar%', 'texto_search_exato': 'estacionar', 'texto_search_inicio': 'estacionar%', 'limit': 20}
2025-03-14 22:56:02,129 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 20 resultados novos
2025-03-14 22:56:02,130 - MultasGO - ERROR - [infracoes.py:138] - Erro ao pesquisar infrações: 'Infracao' object has no attribute 'get'
2025-03-14 22:56:02,130 - MultasGO - ERROR - [infracoes.py:139] - Stack trace: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\api\endpoints\infracoes.py", line 107, in pesquisar
    result = db.execute(text(sql), {"limit": limit, "skip": skip})
                   ^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\.venv\Lib\site-packages\pydantic\main.py", line 759, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Infracao' object has no attribute 'get'

2025-03-14 22:56:02,131 - MultasGO - ERROR - [database.py:111] - Erro na sessão do banco de dados: 
2025-03-14 22:56:02,131 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:56:05,374 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '54870', skip=0, limit=10
2025-03-14 22:56:05,375 - MultasGO - INFO - [search_service.py:116] - Busca original: '54870', normalizada: '54870', código extraído: '54870'
2025-03-14 22:56:06,917 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:56:06,917 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:56:06,918 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {}
2025-03-14 22:56:07,331 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:56:07,332 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:56:07,332 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:56:07,333 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:56:07,334 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {'codigo_exato': '54870', 'codigo_inicio': '54870%', 'codigo_parcial': '%54870%', 'codigo_sem_hifen': '54870', 'limit': 20}
2025-03-14 22:56:07,547 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:56:07,548 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:56:07,548 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {'texto_search': '%54870%', 'texto_search_exato': '54870', 'texto_search_inicio': '54870%', 'limit': 20}
2025-03-14 22:56:07,751 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:56:07,752 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:56:07,752 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {}
2025-03-14 22:56:07,974 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:56:07,975 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:56:07,975 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:56:07,975 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:56:07,977 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 22:56:11,059 - MultasGO - INFO - [infracoes.py:88] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 22:56:11,060 - MultasGO - INFO - [search_service.py:116] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 22:56:11,306 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 22:56:11,307 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 22:56:11,307 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {}
2025-03-14 22:56:11,738 - MultasGO - INFO - [search_service.py:53] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 22:56:11,738 - MultasGO - INFO - [search_service.py:67] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 22:56:11,739 - MultasGO - INFO - [search_service.py:121] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 22:56:11,739 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    ELSE 4
                END
            LIMIT %(limit)s
            
2025-03-14 22:56:11,740 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'limit': 20}
2025-03-14 22:56:11,944 - MultasGO - INFO - [search_service.py:167] - Busca por código encontrou 1 resultados
2025-03-14 22:56:11,944 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 22:56:11,945 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 22:56:12,147 - MultasGO - INFO - [search_service.py:209] - Busca por texto encontrou 0 resultados novos
2025-03-14 22:56:12,148 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 22:56:12,149 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.223e+04s ago] {}
2025-03-14 22:56:12,368 - MultasGO - ERROR - [search_service.py:419] - Erro ao pesquisar infrações: too many values to unpack (expected 2)
2025-03-14 22:56:12,369 - MultasGO - ERROR - [search_service.py:420] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in pesquisar_infracoes
    ORDER BY "Código de Infração" ASC
                       ^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 323, in <listcomp>
    ORDER BY "Código de Infração" ASC
                                ^^^^^^
ValueError: too many values to unpack (expected 2)

2025-03-14 22:56:12,369 - MultasGO - INFO - [infracoes.py:130] - Pesquisa concluída. Total de resultados: 0
2025-03-14 22:56:12,370 - MultasGO - INFO - [infracoes.py:132] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 22:56:12,371 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:17:42,920 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:17:42,921 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:17:42,959 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:20:00,352 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:20:00,352 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:20:00,385 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:20:04,126 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:20:04,126 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:20:04,165 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:20:04,682 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:20:04,712 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:20:04,712 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:20:04,712 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:20:04,712 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:20:04,713 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:20:04,713 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:20:06,779 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:20:06,780 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:20:07,176 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:20:07,177 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:20:07,571 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:20:07,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:20:07,978 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:07,979 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:20:07,980 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00069s] {}
2025-03-14 23:20:08,377 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:20:13,803 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:20:15,519 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:15,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:20:15,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00105s] {'limit': 500, 'skip': 0}
2025-03-14 23:20:16,574 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:20:16,591 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:20:24,898 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:20:24,898 - MultasGO - INFO - [search_service.py:149] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:20:25,102 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:25,103 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:20:25,104 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00104s] {}
2025-03-14 23:20:25,501 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:20:25,502 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:20:25,503 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:20:25,504 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 7579 e variações: 757, 579, 75790
2025-03-14 23:20:25,505 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:20:25,506 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00110s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '579%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:20:25,718 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 2 resultados
2025-03-14 23:20:25,719 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:20:25,720 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00142s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:20:25,944 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:20:25,946 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 2
2025-03-14 23:20:25,952 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:20:29,539 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 23:20:29,540 - MultasGO - INFO - [search_service.py:149] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 23:20:29,748 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:29,749 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:20:29,749 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.647s ago] {}
2025-03-14 23:20:30,142 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:20:30,143 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:20:30,143 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:20:30,143 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 75790 e variações: 7579, 5790, 757900
2025-03-14 23:20:30,144 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:20:30,145 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.641s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '7579%', 'codigo_similar2': '5790%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:20:30,344 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 1 resultados
2025-03-14 23:20:30,345 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:20:30,346 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.627s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 23:20:30,545 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:20:30,546 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:20:30,546 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00077s] {}
2025-03-14 23:20:30,761 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:20:30,764 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:20:39,287 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:20:39,287 - MultasGO - INFO - [search_service.py:149] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:20:39,485 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:39,486 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:20:39,487 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.38s ago] {}
2025-03-14 23:20:39,888 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:20:39,889 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:20:39,889 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:20:39,890 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 75790 e variações: 7579, 5790, 757900
2025-03-14 23:20:39,890 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:20:39,892 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.39s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '7579%', 'codigo_similar2': '5790%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:20:40,093 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 1 resultados
2025-03-14 23:20:40,095 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:20:40,097 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.38s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:20:40,297 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:20:40,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:20:40,299 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00106s] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 23:20:40,498 - MultasGO - INFO - [search_service.py:288] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 23:20:40,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:20:40,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.954s ago] {}
2025-03-14 23:20:40,707 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:20:40,710 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:20:44,871 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:20:44,871 - MultasGO - INFO - [search_service.py:149] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:20:45,066 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:45,067 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:20:45,068 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 19.97s ago] {}
2025-03-14 23:20:45,469 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:20:45,470 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:20:45,472 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:20:45,473 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:20:45,475 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 19.76s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:20:45,688 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:20:45,688 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:20:45,689 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 15.14s ago] {}
2025-03-14 23:20:45,887 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:20:45,890 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:20:50,677 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:20:50,678 - MultasGO - INFO - [search_service.py:149] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:20:50,889 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:20:50,890 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:20:50,892 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 25.79s ago] {}
2025-03-14 23:20:51,287 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:20:51,288 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:20:51,288 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:20:51,289 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:20:51,290 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 25.57s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:20:51,493 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:20:51,494 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:20:51,495 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 20.95s ago] {}
2025-03-14 23:20:51,704 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        
2025-03-14 23:20:51,705 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00093s] {}
2025-03-14 23:20:51,908 - MultasGO - ERROR - [search_service.py:494] - Erro ao pesquisar infrações: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-14 23:20:51,913 - MultasGO - ERROR - [search_service.py:495] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 463, in pesquisar_infracoes
    result_populares = db.execute(text(sql_populares))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-14 23:20:51,914 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:20:51,914 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 23:20:51,917 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:12,405 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:22:12,405 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:22:12,439 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:22:13,776 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:22:13,780 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:22:13,845 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:22:14,401 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:22:14,434 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:22:14,434 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:22:14,434 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:22:14,435 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:22:14,435 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:22:14,435 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:22:16,450 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:22:16,451 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:22:16,859 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:22:16,860 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:22:17,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:22:17,250 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:22:17,661 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:17,662 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:22:17,663 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00082s] {}
2025-03-14 23:22:18,071 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:22:18,213 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:22:19,741 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:19,743 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:22:19,745 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00224s] {'limit': 500, 'skip': 0}
2025-03-14 23:22:20,670 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:22:20,679 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:28,687 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:22:28,689 - MultasGO - INFO - [search_service.py:149] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:22:28,889 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:28,890 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:22:28,891 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00067s] {}
2025-03-14 23:22:29,301 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:22:29,302 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:22:29,302 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:22:29,303 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 7579 e variações: 757, 579, 75790
2025-03-14 23:22:29,304 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:22:29,305 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00101s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '579%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:22:29,546 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 2 resultados
2025-03-14 23:22:29,547 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:22:29,548 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00096s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:22:29,771 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:22:29,772 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 2
2025-03-14 23:22:29,774 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:32,446 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:22:32,446 - MultasGO - INFO - [search_service.py:149] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:22:32,664 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:32,665 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:22:32,666 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.776s ago] {}
2025-03-14 23:22:33,066 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:22:33,067 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:22:33,068 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:22:33,068 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 75790 e variações: 7579, 5790, 757900
2025-03-14 23:22:33,069 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:22:33,070 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.766s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '7579%', 'codigo_similar2': '5790%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:22:33,271 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 1 resultados
2025-03-14 23:22:33,273 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:22:33,275 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.727s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:22:33,477 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:22:33,478 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:22:33,479 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00101s] {'palavra_search': '%7579%', 'limit': 10}
2025-03-14 23:22:33,689 - MultasGO - INFO - [search_service.py:288] - Busca por palavra '7579' encontrou 0 resultados novos
2025-03-14 23:22:33,690 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:22:33,690 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00068s] {}
2025-03-14 23:22:33,889 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:22:33,891 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:38,270 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:22:38,270 - MultasGO - INFO - [search_service.py:149] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:22:38,468 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:38,469 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:22:38,470 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.58s ago] {}
2025-03-14 23:22:38,875 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:22:38,876 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:22:38,876 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:22:38,876 - MultasGO - INFO - [search_service.py:191] - Buscando código exato: 7579 e variações: 757, 579, 75790
2025-03-14 23:22:38,877 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:22:38,878 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.574s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '579%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:22:39,078 - MultasGO - INFO - [search_service.py:216] - Busca por código encontrou 2 resultados
2025-03-14 23:22:39,078 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:22:39,079 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.533s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:22:39,281 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:22:39,283 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 2
2025-03-14 23:22:39,288 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:42,206 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:22:42,207 - MultasGO - INFO - [search_service.py:149] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:22:42,416 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:42,418 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:22:42,420 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 13.53s ago] {}
2025-03-14 23:22:42,828 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:22:42,829 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:22:42,829 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:22:42,830 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:22:42,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 13.28s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:22:43,083 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:22:43,084 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:22:43,084 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.394s ago] {}
2025-03-14 23:22:43,283 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:22:43,286 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:22:45,909 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:22:45,910 - MultasGO - INFO - [search_service.py:149] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:22:46,110 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:22:46,111 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:22:46,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 17.22s ago] {}
2025-03-14 23:22:46,507 - MultasGO - INFO - [search_service.py:86] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:22:46,508 - MultasGO - INFO - [search_service.py:100] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:22:46,508 - MultasGO - INFO - [search_service.py:154] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:22:46,509 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:22:46,510 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 16.96s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:22:46,716 - MultasGO - INFO - [search_service.py:258] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:22:46,717 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:22:46,718 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 13.03s ago] {}
2025-03-14 23:22:46,920 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        
2025-03-14 23:22:46,922 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00204s] {}
2025-03-14 23:22:47,122 - MultasGO - ERROR - [search_service.py:494] - Erro ao pesquisar infrações: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-14 23:22:47,126 - MultasGO - ERROR - [search_service.py:495] - Traceback: Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\app\services\search_service.py", line 463, in pesquisar_infracoes
    result_populares = db.execute(text(sql_populares))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2308, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2199, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\rocha\Desktop\MultasGO_Backups\MultasGO_filipe - alterado\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) for SELECT DISTINCT, ORDER BY expressions must appear in select list
LINE 3:         ORDER BY RANDOM()
                         ^

[SQL: 
        SELECT DISTINCT "Infração" FROM bdbautos 
        ORDER BY RANDOM()
        LIMIT 10
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-03-14 23:22:47,127 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:22:47,127 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Tente uma palavra como 'estacionar' ou 'velocidade', ou um código como '7579''
2025-03-14 23:22:47,130 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:34:39,968 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:34:39,969 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:34:40,005 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:34:41,450 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:34:41,450 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:34:41,487 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:34:42,093 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:34:42,135 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:34:42,135 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:34:42,135 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:34:42,136 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:34:42,136 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:34:42,136 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:34:44,337 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:34:44,339 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:34:44,785 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:34:44,786 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:34:45,285 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:34:45,286 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:34:45,688 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:34:45,689 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:34:45,690 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00070s] {}
2025-03-14 23:34:46,090 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:34:46,372 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:34:47,934 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:34:47,935 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:34:47,936 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00101s] {'limit': 500, 'skip': 0}
2025-03-14 23:34:48,841 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:34:48,849 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:34:54,887 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:34:54,888 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:34:55,085 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:34:55,087 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:34:55,089 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00184s] {}
2025-03-14 23:34:55,494 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:34:55,495 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:34:55,495 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:34:55,496 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-14 23:34:55,497 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:34:55,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00184s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:34:55,698 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:34:55,699 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:34:55,700 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00092s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:34:55,903 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:34:55,904 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:34:55,906 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:34:58,846 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:34:58,847 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:34:59,044 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:34:59,046 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:34:59,046 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.959s ago] {}
2025-03-14 23:34:59,452 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:34:59,452 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:34:59,453 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:34:59,453 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:34:59,454 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:34:59,455 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.957s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:34:59,665 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:34:59,666 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:34:59,666 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.967s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:34:59,870 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:34:59,871 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:34:59,877 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:35:01,598 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 23:35:01,598 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 23:35:01,802 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:35:01,803 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:35:01,804 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6.717s ago] {}
2025-03-14 23:35:02,198 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:35:02,198 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:35:02,199 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:35:02,199 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:35:02,200 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:35:02,201 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6.704s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:35:02,402 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:35:02,403 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:35:02,404 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 6.704s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 23:35:02,619 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:35:02,620 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:35:02,622 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:35:07,419 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:35:07,421 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:35:07,634 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:35:07,635 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:35:07,635 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 12.55s ago] {}
2025-03-14 23:35:08,034 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:35:08,034 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:35:08,035 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:35:08,035 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:35:08,036 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 12.34s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:35:08,239 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:35:08,240 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:08,241 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00090s] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:35:08,444 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:35:08,445 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:08,445 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.2051s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:35:08,652 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:35:08,653 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:08,654 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.4139s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:35:08,851 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:35:08,852 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:08,854 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.6133s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:35:09,052 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:35:09,055 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:09,057 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.8154s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:35:09,256 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:35:09,257 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:09,258 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.017s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:35:09,460 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:35:09,461 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:35:09,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.221s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:35:09,672 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:35:09,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:35:09,674 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00077s] {}
2025-03-14 23:35:09,874 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:35:09,876 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:35:13,221 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:35:13,222 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:35:13,425 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:35:13,426 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:35:13,426 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 18.34s ago] {}
2025-03-14 23:35:13,836 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:35:13,836 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:35:13,837 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:35:13,837 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:35:13,838 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 18.14s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:35:14,037 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:35:14,038 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:35:14,039 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 4.367s ago] {}
2025-03-14 23:35:14,237 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:35:14,238 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00082s] {}
2025-03-14 23:35:14,592 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:35:14,593 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:35:14,594 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:38:59,830 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:38:59,831 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:38:59,862 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:39:01,224 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:39:01,226 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:39:01,289 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:39:01,888 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:39:01,925 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:39:01,925 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:39:01,925 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:39:01,926 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:39:01,926 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:39:01,926 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:39:04,211 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:39:04,213 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:39:04,668 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:39:04,669 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:39:05,109 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:39:05,110 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:39:05,572 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:05,574 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:39:05,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00153s] {}
2025-03-14 23:39:06,011 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:39:06,090 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:39:07,630 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:07,631 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:39:07,631 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00076s] {'limit': 500, 'skip': 0}
2025-03-14 23:39:08,627 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:39:08,636 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:14,904 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:39:14,905 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:39:15,122 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:15,123 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:15,124 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00073s] {}
2025-03-14 23:39:15,574 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:15,575 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:15,576 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:15,576 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-14 23:39:15,577 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:39:15,578 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00164s] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:39:15,816 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:39:15,817 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:15,818 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00082s] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:39:16,041 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:16,042 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:39:16,045 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:18,327 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:39:18,327 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:39:18,568 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:18,568 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:18,569 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.446s ago] {}
2025-03-14 23:39:19,004 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:19,005 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:19,005 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:19,006 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:39:19,006 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:39:19,007 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.43s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:39:19,227 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:39:19,228 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:19,229 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.412s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:39:19,451 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:19,453 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:39:19,458 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:25,529 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 23:39:25,530 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 23:39:25,763 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:25,764 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:25,765 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 10.64s ago] {}
2025-03-14 23:39:26,200 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:26,200 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:26,201 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:26,202 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:39:26,203 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:39:26,204 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 10.63s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:39:26,425 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:39:26,425 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:26,426 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 10.61s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 23:39:26,658 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:26,659 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:39:26,661 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:29,271 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '5010', skip=0, limit=10
2025-03-14 23:39:29,271 - MultasGO - INFO - [search_service.py:174] - Busca original: '5010', normalizada: '5010', código extraído: '5010'
2025-03-14 23:39:29,488 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:29,489 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:29,490 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.37s ago] {}
2025-03-14 23:39:29,928 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:29,929 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:29,931 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:29,931 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 5010 e variações: 501, 0, 50100
2025-03-14 23:39:29,934 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:39:29,936 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.36s ago] {'codigo_exato': '5010', 'codigo_inicio': '5010%', 'codigo_parcial': '%5010%', 'codigo_sem_hifen': '5010', 'codigo_similar1': '501%', 'codigo_similar2': '%0%', 'codigo_similar3': '50100%', 'limit': 20}
2025-03-14 23:39:30,158 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:39:30,159 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:30,160 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 14.34s ago] {'texto_search': '%5010%', 'texto_search_exato': '5010', 'texto_search_inicio': '5010%', 'limit': 20}
2025-03-14 23:39:30,381 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:30,382 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:39:30,384 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:32,981 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '5010-0', skip=0, limit=10
2025-03-14 23:39:32,982 - MultasGO - INFO - [search_service.py:174] - Busca original: '5010-0', normalizada: '5010 0', código extraído: '50100'
2025-03-14 23:39:33,203 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:33,204 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:33,205 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 18.08s ago] {}
2025-03-14 23:39:33,642 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:33,643 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:33,644 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:33,644 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 50100 e variações: 501, 00, 501000
2025-03-14 23:39:33,644 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:39:33,646 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 18.07s ago] {'codigo_exato': '50100', 'codigo_inicio': '50100%', 'codigo_parcial': '%50100%', 'codigo_sem_hifen': '50100', 'codigo_similar1': '501%', 'codigo_similar2': '%00%', 'codigo_similar3': '501000%', 'limit': 20}
2025-03-14 23:39:33,867 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:39:33,868 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:33,869 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 18.05s ago] {'texto_search': '%5010 0%', 'texto_search_exato': '5010 0', 'texto_search_inicio': '5010 0%', 'limit': 20}
2025-03-14 23:39:34,092 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:34,093 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:39:34,096 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:37,967 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:39:37,967 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:39:38,191 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:38,192 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:38,193 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 23.07s ago] {}
2025-03-14 23:39:38,627 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:38,627 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:38,628 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:38,628 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:38,629 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 22.81s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:39:38,849 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:39:38,850 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:38,851 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00083s] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:39:39,069 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:39:39,069 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:39,070 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.2204s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:39:39,288 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:39:39,289 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:39,291 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.4414s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:39:39,513 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:39:39,514 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:39,514 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.6642s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:39:39,744 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:39:39,745 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:39,745 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.8953s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:39:39,964 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:39:39,964 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:39,965 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.115s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:39:40,183 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:39:40,184 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:40,184 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1.334s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:39:40,401 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:39:40,402 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:39:40,402 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00042s] {}
2025-03-14 23:39:40,647 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:39:40,650 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:43,126 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:39:43,127 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:39:43,355 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:43,356 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:43,356 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 28.23s ago] {}
2025-03-14 23:39:43,814 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:43,815 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:43,817 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:43,818 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:43,821 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 28s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:39:44,040 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:44,041 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:39:44,041 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 3.64s ago] {}
2025-03-14 23:39:44,261 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:39:44,262 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00090s] {}
2025-03-14 23:39:44,648 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:39:44,648 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:39:44,650 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:39:46,076 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'Você quis dizer 'chinelo'?', skip=0, limit=10
2025-03-14 23:39:46,078 - MultasGO - INFO - [search_service.py:174] - Busca original: 'Você quis dizer 'chinelo'?', normalizada: 'voce quis dizer 'chinelo'', código extraído: ''
2025-03-14 23:39:46,297 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:39:46,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:39:46,298 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 31.18s ago] {}
2025-03-14 23:39:46,730 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:39:46,731 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:39:46,732 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:39:46,732 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:39:46,733 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 30.92s ago] {'texto_search': "%voce quis dizer 'chinelo'%", 'texto_search_exato': "voce quis dizer 'chinelo'", 'texto_search_inicio': "voce quis dizer 'chinelo'%", 'limit': 20}
2025-03-14 23:39:46,954 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:39:46,955 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:39:46,957 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00182s] {'palavra_search': '%voce%', 'limit': 10}
2025-03-14 23:39:47,176 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'voce' encontrou 0 resultados novos
2025-03-14 23:39:47,177 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:39:47,178 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.2232s ago] {'palavra_search': '%quis%', 'limit': 10}
2025-03-14 23:39:47,397 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'quis' encontrou 0 resultados novos
2025-03-14 23:39:47,398 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:39:47,399 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.4439s ago] {'palavra_search': '%dizer%', 'limit': 10}
2025-03-14 23:39:47,618 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'dizer' encontrou 0 resultados novos
2025-03-14 23:39:47,619 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:39:47,619 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 0.6643s ago] {'palavra_search': "%'chinelo'%", 'limit': 10}
2025-03-14 23:39:47,848 - MultasGO - INFO - [search_service.py:309] - Busca por palavra ''chinelo'' encontrou 0 resultados novos
2025-03-14 23:39:47,850 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:47,851 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.001s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:39:48,070 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:39:48,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:48,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.222s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:39:48,308 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:39:48,308 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:48,309 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.459s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:39:48,535 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:39:48,536 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:48,539 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.689s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:39:48,783 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:39:48,784 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:48,785 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.935s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:39:48,999 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:39:49,000 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:49,001 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 10.15s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:39:49,218 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:39:49,218 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:39:49,219 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 10.37s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:39:49,437 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:39:49,437 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:39:49,438 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 9.036s ago] {}
2025-03-14 23:39:49,669 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:39:49,672 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:40:03,855 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:40:03,855 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:40:04,077 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:40:04,078 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:40:04,079 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 48.96s ago] {}
2025-03-14 23:40:04,521 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:40:04,522 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:40:04,524 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:40:04,525 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:40:04,528 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 48.71s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:40:04,770 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:40:04,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:40:04,772 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 24.37s ago] {}
2025-03-14 23:40:04,989 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:40:04,990 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 20.73s ago] {}
2025-03-14 23:40:05,377 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:40:05,378 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:40:05,380 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:11,281 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:44:11,282 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:44:11,316 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:44:12,798 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:44:12,799 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:44:12,841 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:44:13,046 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:44:13,247 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:13,248 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:44:13,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 305.6s ago] {'limit': 500, 'skip': 0}
2025-03-14 23:44:13,501 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:44:13,534 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:44:13,534 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:44:13,534 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:44:13,534 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:44:13,534 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:44:13,535 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:44:13,974 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:44:13,983 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:15,686 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:44:15,687 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:44:16,080 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:44:16,081 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:44:16,482 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:44:16,482 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:44:16,886 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:16,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:44:16,887 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00055s] {}
2025-03-14 23:44:17,283 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:44:21,975 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:44:21,975 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:44:22,177 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:22,178 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:22,178 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307.1s ago] {}
2025-03-14 23:44:22,591 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:22,591 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:22,592 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:22,592 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-14 23:44:22,593 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:44:22,594 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:44:22,806 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:44:22,807 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:22,810 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:44:23,018 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:44:23,019 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:44:23,021 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:25,359 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 23:44:25,359 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 23:44:25,574 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:25,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:25,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 310.5s ago] {}
2025-03-14 23:44:26,028 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:26,029 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:26,030 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:26,030 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:44:26,031 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:44:26,031 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 310.5s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:44:26,238 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:44:26,240 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:26,242 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 310.4s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 23:44:26,467 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:44:26,468 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:44:26,470 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:28,862 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:44:28,862 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:44:29,063 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:29,064 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:29,064 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 313.9s ago] {}
2025-03-14 23:44:29,467 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:29,467 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:29,468 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:29,468 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:44:29,469 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:44:29,470 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 313.9s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:44:29,704 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:44:29,705 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:29,708 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 313.9s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:44:29,911 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:44:29,912 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:44:29,916 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:33,150 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:44:33,151 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:44:33,353 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:33,353 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:33,354 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 318.2s ago] {}
2025-03-14 23:44:33,772 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:33,773 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:33,773 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:33,774 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:33,775 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 318s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:44:33,979 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:44:33,980 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:33,980 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 295.1s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:44:34,182 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:44:34,183 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:34,183 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 295.3s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:44:34,418 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:44:34,419 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:34,420 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 295.6s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:44:34,636 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:44:34,637 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:34,638 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 295.8s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:44:34,840 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:44:34,842 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:34,844 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 296s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:44:35,046 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:44:35,046 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:35,047 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 296.2s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:44:35,248 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:44:35,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:35,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 296.4s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:44:35,455 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:44:35,456 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:44:35,456 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 295.1s ago] {}
2025-03-14 23:44:35,671 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:44:35,673 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:39,757 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:44:39,758 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:44:39,959 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:39,961 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:39,963 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 324.8s ago] {}
2025-03-14 23:44:40,364 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:40,365 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:40,366 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:40,366 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:40,367 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 324.5s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:44:40,575 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:44:40,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:44:40,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 300.2s ago] {}
2025-03-14 23:44:40,792 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:44:40,792 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 296.5s ago] {}
2025-03-14 23:44:41,144 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:44:41,145 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:44:41,147 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:44:43,360 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'Você quis dizer 'chinelo'?', skip=0, limit=10
2025-03-14 23:44:43,361 - MultasGO - INFO - [search_service.py:174] - Busca original: 'Você quis dizer 'chinelo'?', normalizada: 'voce quis dizer 'chinelo'', código extraído: ''
2025-03-14 23:44:43,571 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:44:43,573 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:44:43,574 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 328.5s ago] {}
2025-03-14 23:44:43,987 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:44:43,987 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:44:43,987 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:44:43,988 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:44:43,989 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 328.2s ago] {'texto_search': "%voce quis dizer 'chinelo'%", 'texto_search_exato': "voce quis dizer 'chinelo'", 'texto_search_inicio': "voce quis dizer 'chinelo'%", 'limit': 20}
2025-03-14 23:44:44,190 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:44:44,191 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:44:44,191 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 297.2s ago] {'palavra_search': '%voce%', 'limit': 10}
2025-03-14 23:44:44,391 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'voce' encontrou 0 resultados novos
2025-03-14 23:44:44,392 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:44:44,393 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 297.4s ago] {'palavra_search': '%quis%', 'limit': 10}
2025-03-14 23:44:44,604 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'quis' encontrou 0 resultados novos
2025-03-14 23:44:44,605 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:44:44,605 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 297.7s ago] {'palavra_search': '%dizer%', 'limit': 10}
2025-03-14 23:44:44,811 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'dizer' encontrou 0 resultados novos
2025-03-14 23:44:44,811 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:44:44,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 297.9s ago] {'palavra_search': "%'chinelo'%", 'limit': 10}
2025-03-14 23:44:45,012 - MultasGO - INFO - [search_service.py:309] - Busca por palavra ''chinelo'' encontrou 0 resultados novos
2025-03-14 23:44:45,013 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:45,015 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 306.2s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:44:45,217 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:44:45,218 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:45,218 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 306.4s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:44:45,418 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:44:45,419 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:45,421 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 306.6s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:44:45,642 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:44:45,643 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:45,644 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 306.8s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:44:45,844 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:44:45,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:45,845 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:44:46,047 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:44:46,047 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:46,048 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307.2s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:44:46,248 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:44:46,249 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:44:46,250 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 307.4s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:44:46,452 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:44:46,452 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:44:46,453 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 306.1s ago] {}
2025-03-14 23:44:46,663 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:44:46,665 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:02,139 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:50:02,139 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:50:02,174 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:50:03,640 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:50:03,641 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:50:03,699 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:50:03,867 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:50:04,091 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:04,093 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:50:04,094 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 656.5s ago] {'limit': 500, 'skip': 0}
2025-03-14 23:50:04,367 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:50:04,399 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:50:04,399 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:50:04,399 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:50:04,399 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:50:04,399 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:50:04,400 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:50:04,871 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:50:04,880 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:06,707 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:50:06,708 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:50:07,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:50:07,135 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:50:07,575 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:50:07,576 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:50:08,023 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:08,024 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:50:08,025 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00047s] {}
2025-03-14 23:50:08,454 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-14 23:50:18,222 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-14 23:50:18,222 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-14 23:50:18,442 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:18,443 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:18,444 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 663.3s ago] {}
2025-03-14 23:50:18,878 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:18,878 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:18,879 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:18,879 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-14 23:50:18,880 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:50:18,881 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 663.3s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-14 23:50:19,100 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:50:19,101 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:19,102 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 663.3s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-14 23:50:19,325 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:19,325 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:50:19,328 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:21,437 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-14 23:50:21,438 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-14 23:50:21,661 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:21,662 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:21,662 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 666.5s ago] {}
2025-03-14 23:50:22,098 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:22,099 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:22,099 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:22,100 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:50:22,100 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:50:22,101 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 666.5s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:50:22,323 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:50:22,323 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:22,324 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 666.5s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-14 23:50:22,548 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:22,549 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:50:22,551 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:24,814 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-14 23:50:24,814 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-14 23:50:25,036 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:25,037 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:25,037 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 669.9s ago] {}
2025-03-14 23:50:25,476 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:25,476 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:25,476 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:25,476 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-14 23:50:25,477 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-14 23:50:25,477 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 669.9s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-14 23:50:25,707 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-14 23:50:25,708 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:25,708 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 669.9s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-14 23:50:25,930 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:25,931 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-14 23:50:25,933 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:39,093 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-14 23:50:39,094 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-14 23:50:39,310 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:39,311 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:39,312 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 684.2s ago] {}
2025-03-14 23:50:39,749 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:39,749 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:39,750 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:39,750 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:39,750 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 683.9s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-14 23:50:39,972 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-14 23:50:39,973 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:39,973 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.1s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:50:40,191 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:50:40,192 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:40,192 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.3s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:50:40,409 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:50:40,410 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:40,411 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.6s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:50:40,642 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:50:40,643 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:40,643 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.8s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:50:40,863 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:50:40,864 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:40,864 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:50:41,081 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:50:41,082 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:41,082 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662.2s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:50:41,299 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:50:41,300 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:41,300 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662.5s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:50:41,532 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:50:41,533 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:50:41,533 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.1s ago] {}
2025-03-14 23:50:41,764 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:50:41,766 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:44,893 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:50:44,894 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:50:45,111 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:45,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:45,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 690s ago] {}
2025-03-14 23:50:45,556 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:45,556 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:45,557 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:45,557 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:45,558 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 689.7s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:50:45,793 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:45,794 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:50:45,795 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 665.4s ago] {}
2025-03-14 23:50:46,011 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:50:46,011 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 661.8s ago] {}
2025-03-14 23:50:46,396 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:50:46,397 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:50:46,398 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:48,409 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'Você quis dizer 'chinelo'?', skip=0, limit=10
2025-03-14 23:50:48,409 - MultasGO - INFO - [search_service.py:174] - Busca original: 'Você quis dizer 'chinelo'?', normalizada: 'voce quis dizer 'chinelo'', código extraído: ''
2025-03-14 23:50:48,631 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:48,631 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:48,632 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 693.5s ago] {}
2025-03-14 23:50:49,068 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:49,069 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:49,069 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:49,070 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:49,071 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 693.3s ago] {'texto_search': "%voce quis dizer 'chinelo'%", 'texto_search_exato': "voce quis dizer 'chinelo'", 'texto_search_inicio': "voce quis dizer 'chinelo'%", 'limit': 20}
2025-03-14 23:50:49,290 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:49,290 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:50:49,291 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662.3s ago] {'palavra_search': '%voce%', 'limit': 10}
2025-03-14 23:50:49,516 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'voce' encontrou 0 resultados novos
2025-03-14 23:50:49,517 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:50:49,517 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662.6s ago] {'palavra_search': '%quis%', 'limit': 10}
2025-03-14 23:50:49,745 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'quis' encontrou 0 resultados novos
2025-03-14 23:50:49,745 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:50:49,746 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 662.8s ago] {'palavra_search': '%dizer%', 'limit': 10}
2025-03-14 23:50:49,965 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'dizer' encontrou 0 resultados novos
2025-03-14 23:50:49,965 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-14 23:50:49,966 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 663s ago] {'palavra_search': "%'chinelo'%", 'limit': 10}
2025-03-14 23:50:50,168 - MultasGO - INFO - [search_service.py:309] - Busca por palavra ''chinelo'' encontrou 0 resultados novos
2025-03-14 23:50:50,168 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:50,169 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 671.3s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-14 23:50:50,371 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-14 23:50:50,371 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:50,372 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 671.5s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-14 23:50:50,583 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-14 23:50:50,583 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:50,583 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 671.7s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-14 23:50:50,784 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-14 23:50:50,785 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:50,786 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 671.9s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-14 23:50:50,989 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-14 23:50:50,990 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:50,990 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 672.1s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-14 23:50:51,192 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-14 23:50:51,192 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:51,193 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 672.3s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-14 23:50:51,396 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-14 23:50:51,397 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-14 23:50:51,397 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 672.5s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-14 23:50:51,613 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-14 23:50:51,613 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:50:51,614 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 671.2s ago] {}
2025-03-14 23:50:51,821 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-14 23:50:51,823 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:50:57,578 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-14 23:50:57,578 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-14 23:50:57,786 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:50:57,787 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-14 23:50:57,787 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 702.7s ago] {}
2025-03-14 23:50:58,184 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-14 23:50:58,185 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-14 23:50:58,185 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-14 23:50:58,186 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-14 23:50:58,186 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 702.4s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-14 23:50:58,385 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-14 23:50:58,386 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-14 23:50:58,387 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 678s ago] {}
2025-03-14 23:50:58,595 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-14 23:50:58,596 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 674.3s ago] {}
2025-03-14 23:50:58,948 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-14 23:50:58,948 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-14 23:50:58,950 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:59:48,736 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:59:48,736 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:59:48,768 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:59:50,406 - MultasGO - DEBUG - [logger.py:47] - Logger configurado com nível: DEBUG
2025-03-14 23:59:50,407 - MultasGO - INFO - [database.py:25] - Usando conexão remota com banco de dados do Railway via URL pública
2025-03-14 23:59:50,462 - MultasGO - INFO - [database.py:83] - Conexão com o banco de dados estabelecida com sucesso
2025-03-14 23:59:50,531 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-14 23:59:50,738 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:59:50,739 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-14 23:59:50,740 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1243s ago] {'limit': 500, 'skip': 0}
2025-03-14 23:59:51,181 - asyncio - DEBUG - [selector_events.py:54] - Using selector: SelectSelector
2025-03-14 23:59:51,213 - MultasGO - INFO - [main.py:89] - Iniciando a aplicação MultasGO...
2025-03-14 23:59:51,213 - MultasGO - INFO - [main.py:93] - Configurações de banco de dados:
2025-03-14 23:59:51,213 - MultasGO - INFO - [main.py:94] - Host: ballast.proxy.rlwy.net
2025-03-14 23:59:51,213 - MultasGO - INFO - [main.py:95] - Porta: 40799
2025-03-14 23:59:51,214 - MultasGO - INFO - [main.py:96] - Usuário: postgres
2025-03-14 23:59:51,214 - MultasGO - INFO - [main.py:97] - Database: railway
2025-03-14 23:59:51,446 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-14 23:59:51,453 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-14 23:59:53,461 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select pg_catalog.version()
2025-03-14 23:59:53,462 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:59:53,872 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - select current_schema()
2025-03-14 23:59:53,874 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:59:54,275 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - show standard_conforming_strings
2025-03-14 23:59:54,275 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [raw sql] {}
2025-03-14 23:59:54,689 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-14 23:59:54,691 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - SELECT 1
2025-03-14 23:59:54,691 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [generated in 0.00048s] {}
2025-03-14 23:59:55,088 - MultasGO - INFO - [main.py:103] - Conexão com o banco de dados verificada com sucesso.
2025-03-15 00:00:00,687 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-15 00:00:00,687 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-15 00:00:00,888 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:00,888 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:00,889 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1246s ago] {}
2025-03-15 00:00:01,293 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:01,293 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:01,294 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:01,294 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-15 00:00:01,295 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:00:01,295 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1246s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-15 00:00:01,497 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:00:01,498 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:01,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1246s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-15 00:00:01,705 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:00:01,706 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:00:01,709 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:00:04,214 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-15 00:00:04,216 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-15 00:00:04,421 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:04,422 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:04,423 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1249s ago] {}
2025-03-15 00:00:04,838 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:04,839 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:04,839 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:04,839 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:00:04,840 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:00:04,840 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1249s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:00:05,047 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:00:05,048 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:05,049 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1249s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-15 00:00:05,253 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:00:05,253 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:00:05,256 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:00:06,941 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-15 00:00:06,942 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-15 00:00:07,140 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:07,140 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:07,141 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1252s ago] {}
2025-03-15 00:00:07,541 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:07,542 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:07,542 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:07,542 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:00:07,543 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:00:07,543 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1252s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:00:07,768 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:00:07,768 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:07,769 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1252s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-15 00:00:07,975 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:00:07,975 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:00:07,978 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:00:12,317 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-15 00:00:12,318 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-15 00:00:12,519 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:12,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:12,520 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1257s ago] {}
2025-03-15 00:00:12,928 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:12,929 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:12,929 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:12,930 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:12,930 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1257s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-15 00:00:13,135 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-15 00:00:13,136 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:13,136 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1234s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-15 00:00:13,338 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-15 00:00:13,339 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:13,340 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1234s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-15 00:00:13,549 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-15 00:00:13,550 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:13,550 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1235s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-15 00:00:13,757 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-15 00:00:13,758 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:13,758 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1235s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-15 00:00:13,968 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-15 00:00:13,968 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:13,969 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1235s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-15 00:00:14,172 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-15 00:00:14,173 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:14,174 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1235s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-15 00:00:14,376 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-15 00:00:14,377 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:14,377 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1236s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-15 00:00:14,586 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-15 00:00:14,586 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:00:14,587 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1234s ago] {}
2025-03-15 00:00:14,789 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-15 00:00:14,791 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:00:18,207 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-15 00:00:18,207 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-15 00:00:18,407 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:18,408 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:18,408 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1263s ago] {}
2025-03-15 00:00:18,810 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:18,811 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:18,812 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:18,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:18,813 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1263s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-15 00:00:19,016 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:00:19,017 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:00:19,017 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1239s ago] {}
2025-03-15 00:00:19,219 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-15 00:00:19,219 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1235s ago] {}
2025-03-15 00:00:19,578 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-15 00:00:19,578 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-15 00:00:19,580 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:00:27,820 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'Você quis dizer 'chinelo'?', skip=0, limit=10
2025-03-15 00:00:27,821 - MultasGO - INFO - [search_service.py:174] - Busca original: 'Você quis dizer 'chinelo'?', normalizada: 'voce quis dizer 'chinelo'', código extraído: ''
2025-03-15 00:00:28,027 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:00:28,027 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:00:28,028 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1273s ago] {}
2025-03-15 00:00:28,430 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:00:28,430 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:00:28,431 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:00:28,431 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:00:28,432 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1273s ago] {'texto_search': "%voce quis dizer 'chinelo'%", 'texto_search_exato': "voce quis dizer 'chinelo'", 'texto_search_inicio': "voce quis dizer 'chinelo'%", 'limit': 20}
2025-03-15 00:00:28,670 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:00:28,671 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:00:28,671 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1242s ago] {'palavra_search': '%voce%', 'limit': 10}
2025-03-15 00:00:28,874 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'voce' encontrou 0 resultados novos
2025-03-15 00:00:28,875 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:00:28,876 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1242s ago] {'palavra_search': '%quis%', 'limit': 10}
2025-03-15 00:00:29,098 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'quis' encontrou 0 resultados novos
2025-03-15 00:00:29,099 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:00:29,099 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1242s ago] {'palavra_search': '%dizer%', 'limit': 10}
2025-03-15 00:00:29,300 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'dizer' encontrou 0 resultados novos
2025-03-15 00:00:29,301 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:00:29,301 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1242s ago] {'palavra_search': "%'chinelo'%", 'limit': 10}
2025-03-15 00:00:29,505 - MultasGO - INFO - [search_service.py:309] - Busca por palavra ''chinelo'' encontrou 0 resultados novos
2025-03-15 00:00:29,506 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:29,507 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-15 00:00:29,709 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-15 00:00:29,710 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:29,711 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-15 00:00:29,913 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-15 00:00:29,913 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:29,914 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-15 00:00:30,117 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-15 00:00:30,118 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:30,118 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-15 00:00:30,319 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-15 00:00:30,320 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:30,320 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-15 00:00:30,523 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-15 00:00:30,524 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:30,524 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1252s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-15 00:00:30,737 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-15 00:00:30,738 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:00:30,738 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1252s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-15 00:00:30,940 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-15 00:00:30,941 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:00:30,942 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 1251s ago] {}
2025-03-15 00:00:31,144 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-15 00:00:31,146 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:12:46,357 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-15 00:12:46,568 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:12:46,569 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-15 00:12:46,570 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2019s ago] {'limit': 500, 'skip': 0}
2025-03-15 00:12:47,274 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-15 00:12:47,330 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:12:54,063 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-15 00:12:54,064 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-15 00:12:54,264 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:12:54,265 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:12:54,265 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2019s ago] {}
2025-03-15 00:12:54,714 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:12:54,715 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:12:54,715 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:12:54,716 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-15 00:12:54,716 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:12:54,717 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2019s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-15 00:12:54,922 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:12:54,923 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:12:54,924 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2019s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-15 00:12:55,132 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:12:55,133 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:12:55,135 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:12:57,110 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-15 00:12:57,110 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-15 00:12:57,310 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:12:57,311 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:12:57,311 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2022s ago] {}
2025-03-15 00:12:57,735 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:12:57,735 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:12:57,736 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:12:57,736 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:12:57,737 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:12:57,737 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2022s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:12:57,943 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:12:57,943 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:12:57,944 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2022s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-15 00:12:58,150 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:12:58,150 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:12:58,153 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:12:59,518 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-15 00:12:59,518 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-15 00:12:59,723 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:12:59,723 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:12:59,724 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2025s ago] {}
2025-03-15 00:13:00,125 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:13:00,125 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:13:00,126 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:13:00,126 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:13:00,126 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:13:00,127 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2025s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:13:00,349 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:13:00,349 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:13:00,350 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2025s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-15 00:13:00,556 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:13:00,557 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:13:00,559 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:13:04,062 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinelo', skip=0, limit=10
2025-03-15 00:13:04,063 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinelo', normalizada: 'chinelo', código extraído: ''
2025-03-15 00:13:04,262 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:13:04,263 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:13:04,263 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2029s ago] {}
2025-03-15 00:13:04,669 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:13:04,670 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:13:04,670 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:13:04,671 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:13:04,671 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2029s ago] {'texto_search': '%chinelo%', 'texto_search_exato': 'chinelo', 'texto_search_inicio': 'chinelo%', 'limit': 20}
2025-03-15 00:13:04,875 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-15 00:13:04,876 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:04,877 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2006s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-15 00:13:05,078 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-15 00:13:05,079 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:05,079 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2006s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-15 00:13:05,281 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-15 00:13:05,281 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:05,282 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2006s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-15 00:13:05,498 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-15 00:13:05,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:05,499 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2007s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-15 00:13:05,704 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-15 00:13:05,704 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:05,705 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2007s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-15 00:13:05,907 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-15 00:13:05,908 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:05,908 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2007s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-15 00:13:06,110 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-15 00:13:06,111 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:13:06,111 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2007s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-15 00:13:06,311 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-15 00:13:06,312 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:13:06,312 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2006s ago] {}
2025-03-15 00:13:06,515 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-15 00:13:06,518 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:13:08,941 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-15 00:13:08,942 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-15 00:13:09,141 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:13:09,142 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:13:09,143 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2034s ago] {}
2025-03-15 00:13:09,552 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:13:09,553 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:13:09,553 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:13:09,554 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:13:09,554 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2034s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-15 00:13:09,769 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:13:09,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:13:09,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2009s ago] {}
2025-03-15 00:13:09,973 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-15 00:13:09,974 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2006s ago] {}
2025-03-15 00:13:10,324 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-15 00:13:10,324 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-15 00:13:10,326 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:04,612 - MultasGO - INFO - [infracoes.py:89] - Listando infrações com skip=0, limit=500
2025-03-15 00:28:04,830 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:04,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT 
            "Código de Infração" as codigo,
            "Infração" as descricao,
            "Responsável" as responsavel,
            "Valor da Multa" as valor_multa,
            "Órgão Autuador" as orgao_autuador,
            "Artigos do CTB" as artigos_ctb,
            pontos,
            gravidade
        FROM bdbautos
        ORDER BY "Código de Infração"
        LIMIT %(limit)s OFFSET %(skip)s
        
2025-03-15 00:28:04,831 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2937s ago] {'limit': 500, 'skip': 0}
2025-03-15 00:28:05,533 - MultasGO - INFO - [infracoes.py:136] - Listagem de infrações: 439 registros retornados
2025-03-15 00:28:05,545 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:09,071 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579', skip=0, limit=10
2025-03-15 00:28:09,071 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579', normalizada: '7579', código extraído: '7579'
2025-03-15 00:28:09,273 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:09,273 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:09,274 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2934s ago] {}
2025-03-15 00:28:09,693 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:09,694 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:09,694 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:09,694 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 7579 e variações: 757, 9, 75790
2025-03-15 00:28:09,695 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:28:09,696 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2934s ago] {'codigo_exato': '7579', 'codigo_inicio': '7579%', 'codigo_parcial': '%7579%', 'codigo_sem_hifen': '7579', 'codigo_similar1': '757%', 'codigo_similar2': '%9%', 'codigo_similar3': '75790%', 'limit': 20}
2025-03-15 00:28:09,897 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:28:09,897 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:09,898 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2934s ago] {'texto_search': '%7579%', 'texto_search_exato': '7579', 'texto_search_inicio': '7579%', 'limit': 20}
2025-03-15 00:28:10,104 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:28:10,105 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:28:10,107 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:12,022 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '75790', skip=0, limit=10
2025-03-15 00:28:12,023 - MultasGO - INFO - [search_service.py:174] - Busca original: '75790', normalizada: '75790', código extraído: '75790'
2025-03-15 00:28:12,221 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:12,222 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:12,223 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2937s ago] {}
2025-03-15 00:28:12,660 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:12,661 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:12,661 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:12,662 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:28:12,662 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:28:12,663 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2937s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:28:12,867 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:28:12,867 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:12,868 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2937s ago] {'texto_search': '%75790%', 'texto_search_exato': '75790', 'texto_search_inicio': '75790%', 'limit': 20}
2025-03-15 00:28:13,072 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:28:13,072 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:28:13,074 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:14,911 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: '7579-0', skip=0, limit=10
2025-03-15 00:28:14,912 - MultasGO - INFO - [search_service.py:174] - Busca original: '7579-0', normalizada: '7579 0', código extraído: '75790'
2025-03-15 00:28:15,111 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:15,112 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:15,113 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2940s ago] {}
2025-03-15 00:28:15,513 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:15,514 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:15,514 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:15,514 - MultasGO - INFO - [search_service.py:190] - Buscando código exato: 75790 e variações: 757, 90, 757900
2025-03-15 00:28:15,515 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT * FROM bdbautos 
            WHERE CAST("Código de Infração" AS TEXT) = %(codigo_exato)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_parcial)s
               OR REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s
               OR CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s
            ORDER BY 
                CASE 
                    WHEN CAST("Código de Infração" AS TEXT) = %(codigo_exato)s THEN 1
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_inicio)s THEN 2
                    WHEN REPLACE(CAST("Código de Infração" AS TEXT), '-', '') = %(codigo_sem_hifen)s THEN 3
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar1)s THEN 4
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar2)s THEN 5
                    WHEN CAST("Código de Infração" AS TEXT) LIKE %(codigo_similar3)s THEN 6
                    ELSE 7
                END
            LIMIT %(limit)s
            
2025-03-15 00:28:15,516 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2940s ago] {'codigo_exato': '75790', 'codigo_inicio': '75790%', 'codigo_parcial': '%75790%', 'codigo_sem_hifen': '75790', 'codigo_similar1': '757%', 'codigo_similar2': '%90%', 'codigo_similar3': '757900%', 'limit': 20}
2025-03-15 00:28:15,724 - MultasGO - INFO - [search_service.py:237] - Busca por código encontrou 20 resultados
2025-03-15 00:28:15,725 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:15,726 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2940s ago] {'texto_search': '%7579 0%', 'texto_search_exato': '7579 0', 'texto_search_inicio': '7579 0%', 'limit': 20}
2025-03-15 00:28:15,930 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:28:15,932 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 20
2025-03-15 00:28:15,934 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:22,318 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'chinel', skip=0, limit=10
2025-03-15 00:28:22,318 - MultasGO - INFO - [search_service.py:174] - Busca original: 'chinel', normalizada: 'chinel', código extraído: ''
2025-03-15 00:28:22,519 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:22,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:22,521 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2947s ago] {}
2025-03-15 00:28:22,923 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:22,924 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:22,925 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:22,925 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:22,926 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2947s ago] {'texto_search': '%chinel%', 'texto_search_exato': 'chinel', 'texto_search_inicio': 'chinel%', 'limit': 20}
2025-03-15 00:28:23,130 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 1 resultados novos
2025-03-15 00:28:23,130 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:23,131 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2924s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-15 00:28:23,330 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-15 00:28:23,331 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:23,332 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2924s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-15 00:28:23,562 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-15 00:28:23,563 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:23,564 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2925s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-15 00:28:23,769 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-15 00:28:23,770 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:23,771 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2925s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-15 00:28:23,970 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-15 00:28:23,971 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:23,971 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2925s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-15 00:28:24,194 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-15 00:28:24,194 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:24,195 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2925s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-15 00:28:24,394 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-15 00:28:24,395 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:24,395 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2926s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-15 00:28:24,623 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-15 00:28:24,623 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:28:24,624 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2924s ago] {}
2025-03-15 00:28:24,841 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-15 00:28:24,843 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:30,598 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'xinelo', skip=0, limit=10
2025-03-15 00:28:30,598 - MultasGO - INFO - [search_service.py:174] - Busca original: 'xinelo', normalizada: 'xinelo', código extraído: ''
2025-03-15 00:28:30,812 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:30,812 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:30,813 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2956s ago] {}
2025-03-15 00:28:31,235 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:31,235 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:31,236 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:31,236 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:31,237 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2955s ago] {'texto_search': '%xinelo%', 'texto_search_exato': 'xinelo', 'texto_search_inicio': 'xinelo%', 'limit': 20}
2025-03-15 00:28:31,457 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:28:31,458 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:28:31,458 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2931s ago] {}
2025-03-15 00:28:31,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT DISTINCT "Infração" FROM bdbautos
        LIMIT 500
        
2025-03-15 00:28:31,673 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2927s ago] {}
2025-03-15 00:28:32,038 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 0
2025-03-15 00:28:32,039 - MultasGO - INFO - [infracoes.py:251] - Sugestão encontrada: 'Você quis dizer 'chinelo'?'
2025-03-15 00:28:32,041 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
2025-03-15 00:28:50,865 - MultasGO - INFO - [infracoes.py:170] - Iniciando pesquisa com termo: 'Você quis dizer 'chinelo'?', skip=0, limit=10
2025-03-15 00:28:50,866 - MultasGO - INFO - [search_service.py:174] - Busca original: 'Você quis dizer 'chinelo'?', normalizada: 'voce quis dizer 'chinelo'', código extraído: ''
2025-03-15 00:28:51,069 - sqlalchemy.engine.Engine - INFO - [base.py:2689] - BEGIN (implicit)
2025-03-15 00:28:51,069 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        LIMIT 10
        
2025-03-15 00:28:51,070 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2976s ago] {}
2025-03-15 00:28:51,478 - MultasGO - INFO - [search_service.py:111] - Diagnóstico de banco - colunas: ['Código de Infração', 'Infração', 'Responsável', 'Valor da Multa', 'Órgão Autuador', 'Artigos do CTB', 'pontos', 'gravidade']
2025-03-15 00:28:51,480 - MultasGO - INFO - [search_service.py:125] - Diagnóstico de banco - primeiros registros: [{'Código de Infração': 54870, 'Infração': 'Estacionar ao lado de outro veículo em fila dupla ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55173, 'Infração': 'Estacionar nos túneis ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55330, 'Infração': 'Estacionar aclive/declive não freado e sem calço segurança, PBT (peso) superior a 3500kg ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XVI ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 55172, 'Infração': 'Estacionar nas pontes ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * XIV ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 56142, 'Infração': 'Parar na pista de rolamento das Rodovias ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '182 * V ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54527, 'Infração': 'Estacionar ao lado ou sobre gramado ou jardim público ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 76090, 'Infração': 'Organizar a conduta prevista no caput do art.253-A ', 'Responsável': 'PF ou PJ ', 'Valor da Multa': '17608.2', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '253-A, § 1º ', 'pontos': '7.0', 'gravidade': 'gravíssima60x'}, {'Código de Infração': 54524, 'Infração': 'Estacionar nas ilhas ou refúgios ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54523, 'Infração': 'Estacionar sobre ciclovia ou ciclofaixa ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181 * VIII ', 'pontos': '5.0', 'gravidade': 'grave'}, {'Código de Infração': 54010, 'Infração': 'Estacionar afastado da guia da calçada (meio-fio) a mais de 1m ', 'Responsável': 'Condutor ', 'Valor da Multa': '195.23', 'Órgão Autuador': 'Municipal/Rodoviário ', 'Artigos do CTB': '181, III ', 'pontos': '5.0', 'gravidade': 'grave'}]
2025-03-15 00:28:51,480 - MultasGO - INFO - [search_service.py:179] - Diagnóstico do banco: encontrados 10 registros de exemplo
2025-03-15 00:28:51,481 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
        SELECT * FROM bdbautos 
        WHERE LOWER("Infração") LIKE LOWER(%(texto_search)s)
           OR LOWER("Responsável") LIKE LOWER(%(texto_search)s)
           OR LOWER("Artigos do CTB") LIKE LOWER(%(texto_search)s)
           OR LOWER("Órgão Autuador") LIKE LOWER(%(texto_search)s)
           OR LOWER("gravidade") LIKE LOWER(%(texto_search)s)
        ORDER BY 
            CASE 
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_exato)s) THEN 1
                WHEN LOWER("Infração") LIKE LOWER(%(texto_search_inicio)s) THEN 2
                ELSE 3
            END
        LIMIT %(limit)s
        
2025-03-15 00:28:51,482 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2976s ago] {'texto_search': "%voce quis dizer 'chinelo'%", 'texto_search_exato': "voce quis dizer 'chinelo'", 'texto_search_inicio': "voce quis dizer 'chinelo'%", 'limit': 20}
2025-03-15 00:28:51,698 - MultasGO - INFO - [search_service.py:279] - Busca por texto encontrou 0 resultados novos
2025-03-15 00:28:51,700 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:28:51,701 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2945s ago] {'palavra_search': '%voce%', 'limit': 10}
2025-03-15 00:28:51,902 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'voce' encontrou 0 resultados novos
2025-03-15 00:28:51,902 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:28:51,903 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2945s ago] {'palavra_search': '%quis%', 'limit': 10}
2025-03-15 00:28:52,104 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'quis' encontrou 0 resultados novos
2025-03-15 00:28:52,104 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:28:52,105 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2945s ago] {'palavra_search': '%dizer%', 'limit': 10}
2025-03-15 00:28:52,313 - MultasGO - INFO - [search_service.py:309] - Busca por palavra 'dizer' encontrou 0 resultados novos
2025-03-15 00:28:52,314 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                    SELECT * FROM bdbautos 
                    WHERE LOWER("Infração") LIKE LOWER(%(palavra_search)s)
                    ORDER BY LENGTH("Infração") ASC
                    LIMIT %(limit)s
                    
2025-03-15 00:28:52,315 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2945s ago] {'palavra_search': "%'chinelo'%", 'limit': 10}
2025-03-15 00:28:52,521 - MultasGO - INFO - [search_service.py:309] - Busca por palavra ''chinelo'' encontrou 0 resultados novos
2025-03-15 00:28:52,522 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:52,523 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {'termo_search': '%chinelo%', 'limit': 10}
2025-03-15 00:28:52,725 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinelo' encontrou 1 resultados novos
2025-03-15 00:28:52,726 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:52,726 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {'termo_search': '%tamancos%', 'limit': 10}
2025-03-15 00:28:52,929 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'tamancos' encontrou 0 resultados novos
2025-03-15 00:28:52,929 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:52,929 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {'termo_search': '%sandalia%', 'limit': 10}
2025-03-15 00:28:53,133 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'sandalia' encontrou 0 resultados novos
2025-03-15 00:28:53,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:53,134 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {'termo_search': '%calçado%', 'limit': 10}
2025-03-15 00:28:53,335 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'calçado' encontrou 1 resultados novos
2025-03-15 00:28:53,336 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:53,337 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {'termo_search': '%pantufa%', 'limit': 10}
2025-03-15 00:28:53,543 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'pantufa' encontrou 0 resultados novos
2025-03-15 00:28:53,544 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:53,545 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2955s ago] {'termo_search': '%chinela%', 'limit': 10}
2025-03-15 00:28:53,746 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'chinela' encontrou 0 resultados novos
2025-03-15 00:28:53,747 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
                            SELECT * FROM bdbautos 
                            WHERE LOWER("Infração") LIKE LOWER(%(termo_search)s)
                            ORDER BY "Código de Infração" ASC
                            LIMIT %(limit)s
                            
2025-03-15 00:28:53,748 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2955s ago] {'termo_search': '%rasteirinha%', 'limit': 10}
2025-03-15 00:28:53,949 - MultasGO - INFO - [search_service.py:364] - Busca por termo especial 'rasteirinha' encontrou 0 resultados novos
2025-03-15 00:28:53,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - 
            SELECT DISTINCT "Infração" FROM bdbautos 
            LIMIT 100
            
2025-03-15 00:28:53,950 - sqlalchemy.engine.Engine - INFO - [base.py:1848] - [cached since 2954s ago] {}
2025-03-15 00:28:54,152 - MultasGO - INFO - [infracoes.py:249] - Pesquisa concluída. Total de resultados: 1
2025-03-15 00:28:54,154 - sqlalchemy.engine.Engine - INFO - [base.py:2692] - ROLLBACK
